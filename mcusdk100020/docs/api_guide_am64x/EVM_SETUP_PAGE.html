<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: EVM Setup</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EVM_SETUP_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EVM Setup </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#EVM_CABLES">Cable Connections</a><ul><li class="level2"><a href="#autotoc_md28">AM64X-EVM</a></li>
<li class="level2"><a href="#autotoc_md29">AM64X-SK</a></li>
</ul>
</li>
<li class="level1"><a href="#DEVICE_TYPE">Device Type Identification</a></li>
<li class="level1"><a href="#CCS_UART_TERMINAL">Setup UART Terminal</a><ul><li class="level2"><a href="#autotoc_md30">AM64X-EVM</a></li>
<li class="level2"><a href="#autotoc_md31">AM64X-SK</a></li>
</ul>
</li>
<li class="level1"><a href="#EVM_FLASH_SOC_INIT">Flash SOC Initialization Binary</a><ul><li class="level2"><a href="#autotoc_md32">AM64X-EVM</a></li>
<li class="level2"><a href="#autotoc_md33">AM64X-SK</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md34">Additional Details</a><ul><li class="level2"><a href="#EVM_SOC_INIT">SOC Initialization</a><ul><li class="level3"><a href="#EVM_SOC_INIT_SD_BOOT_MODE">SOC Initialization Using SD BOOT</a><ul><li class="level4"><a href="#autotoc_md35">AM64X-EVM</a></li>
<li class="level4"><a href="#autotoc_md36">AM64X-SK</a></li>
</ul>
</li>
<li class="level3"><a href="#EVM_SOC_INIT_NOBOOT_MODE">SOC Initialization Using CCS Scripting</a><ul><li class="level4"><a href="#autotoc_md37">Set Environment Variable</a></li>
<li class="level4"><a href="#autotoc_md38">Run the SOC Initialization Script</a></li>
<li class="level4"><a href="#DDR_INIT">DDR Initialization</a></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md39">BOOT MODE</a><ul><li class="level3"><a href="#BOOTMODE_UART">UART BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md40">AM64X-EVM</a></li>
<li class="level4"><a href="#autotoc_md41">AM64X-SK</a></li>
</ul>
</li>
<li class="level3"><a href="#BOOTMODE_DFU">DFU BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md42">AM64x-EVM</a></li>
</ul>
</li>
<li class="level3"><a href="#BOOTMODE_OSPI">OSPI BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md43">AM64X-EVM</a></li>
<li class="level4"><a href="#autotoc_md44">AM64X-SK</a></li>
</ul>
</li>
<li class="level3"><a href="#BOOTMODE_SD">SD BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md45">AM64X-EVM</a></li>
<li class="level4"><a href="#autotoc_md46">AM64X-SK</a></li>
</ul>
</li>
<li class="level3"><a href="#BOOTMODE_NOBOOT">DEV BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md47">AM64X-EVM</a></li>
<li class="level4"><a href="#autotoc_md48">AM64X-SK</a></li>
</ul>
</li>
<li class="level3"><a href="#BOOTMODE_EMMC">EMMC BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md49">AM64X-EVM</a></li>
</ul>
</li>
<li class="level3"><a href="#BOOTMODE_PCIE">PCIE BOOT MODE</a><ul><li class="level4"><a href="#autotoc_md50">AM64X-EVM</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#TROUBLESHOOT_ISSUES">Troubleshooting EVM issues</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_device_am64x_am64x_evm_setup"></a></p>
<dl class="section note"><dt>Note</dt><dd>Refer to EVM page for more details on the EVM, <a href="https://www.ti.com/tool/TMDS64GPEVM">https://www.ti.com/tool/TMDS64GPEVM</a> <br  />
 Refer to SK page for more details on the AM64X-SK, <a href="https://www.ti.com/tool/SK-AM64">https://www.ti.com/tool/SK-AM64</a></dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>This document contains the details for AM64X-EVM and AM64X-SK board setup under each section. User should select the right board setup in the sections.</dd></dl>
<h1><a class="anchor" id="EVM_CABLES"></a>
Cable Connections</h1>
<h2><a class="anchor" id="autotoc_md28"></a>
AM64X-EVM</h2>
<ul>
<li>The figure below shows some important cable connections, ports and switches.<ul>
<li>Take note of the location of the "BOOTMODE" switch, this is used to switch between different boot modes like OSPI, UART, SD, NOBOOT mode</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="evm_overview.png"]{width:50%}</style> </p><div class="image">
<img src="evm_overview.png" alt=""/>
<div class="caption">
AM64X-EVM</div></div>
<h2><a class="anchor" id="autotoc_md29"></a>
AM64X-SK</h2>
<ul>
<li>The figure below shows some important cable connections, ports and switches.<ul>
<li>Take note of the location of the "BOOTMODE" switch, this is used to switch between different boot modes like OSPI, UART, SD, NOBOOT mode</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="sk_overview.png"]{width:60%}</style> </p><div class="image">
<img src="sk_overview.png" alt=""/>
<div class="caption">
AM64X-SK</div></div>
<h1><a class="anchor" id="DEVICE_TYPE"></a>
Device Type Identification</h1>
<ul>
<li>The MCU+SDK supports two device types: HS-FS (High Security - Field Securable) and GP (General Purpose). The HS-FS is the main device type and the support for GP device is deprecated. Please use <a class="el" href="TOOLS_BOOT.html#SOC_ID_PARSER">SoC ID parser Python Script</a> to identify the device type.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>It is recommended to know the device type before loading or flashing the binary into the target.</dd></dl>
<h1><a class="anchor" id="CCS_UART_TERMINAL"></a>
Setup UART Terminal</h1>
<h2><a class="anchor" id="autotoc_md30"></a>
AM64X-EVM</h2>
<ul>
<li>Many examples use a standard UART terminal to log the output from the examples. You can use any UART terminal program for the same. Below steps show how to setup the UART terminal from CCS.</li>
<li>First identify the UART port as enumerated on the host machine.<ul>
<li>Make sure that the EVM and UART cable connected as shown in <a class="el" href="EVM_SETUP_PAGE.html#EVM_CABLES">Cable Connections</a></li>
<li>In windows, you can use the "Device Manager" to see the detected UART ports<ul>
<li>Search "Device Manager" in Windows Search Box in the Windows taskbar.</li>
</ul>
</li>
<li>If dont see any USB serial ports listed in "Device Manager" under "Ports (COM &amp; LPT)", then make sure you have installed the UART to USB driver from FTDI, <a href="https://www.ftdichip.com/FTDrivers.htm">https://www.ftdichip.com/FTDrivers.htm</a>.</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="ccs_uart_identify.png"]{width:30%}</style> </p><div class="image">
<img src="ccs_uart_identify.png" alt=""/>
<div class="caption">
Identify UART Port in Windows Device Manager</div></div>
<ul>
<li>In CCS, goto "View &gt; Terminal"</li>
</ul>
<p> <style>div.image img[src="ccs_uart_00.png"]{width:20%}</style> </p><div class="image">
<img src="ccs_uart_00.png" alt=""/>
<div class="caption">
UART Terminal Menu</div></div>
<ul>
<li>Open a new UART terminal</li>
</ul>
<p> <style>div.image img[src="ccs_uart_01.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_uart_01.png" alt=""/>
<div class="caption">
Open New UART Terminal</div></div>
<ul>
<li>Select the UART port, keep other options to default, i.e 115200 baud rate - 8 data bits - No parity - 1 stop bit,<ul>
<li>We use the 1st USB serial port, as seen in the device manager, for below in the SDK<ul>
<li>Flashing application via UART</li>
<li>Booting application via UART</li>
<li>Console output for examples which run from R5F</li>
</ul>
</li>
<li>We use the 2nd USB serial port, as seen in the device manager, as terminal output for examples which run from M4F</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="ccs_uart_02.png"]{width:25%}</style> </p><div class="image">
<img src="ccs_uart_02.png" alt=""/>
<div class="caption">
Connect to UART port</div></div>
<ul>
<li>In this screenshot this happens to be COM13 and COM14 however on your machine this could be different. One tip to make sure there is no mistake in identifying the UART port is to disconnect all other UART to USB devices other than this EVM before checking in device manager.</li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
AM64X-SK</h2>
<ul>
<li>Many examples use a standard UART terminal to log the output from the examples. You can use any UART terminal program for the same. Below steps show how to setup the UART terminal from CCS.</li>
<li>First identify the UART port as enumerated on the host machine.<ul>
<li>Make sure that the AM64X-SK and UART cable connected as shown in <a class="el" href="EVM_SETUP_PAGE.html#EVM_CABLES">Cable Connections</a></li>
<li>In windows, you can use the "Device Manager" to see the detected UART ports<ul>
<li>Search "Device Manager" in Windows Search Box in the Windows taskbar.</li>
</ul>
</li>
<li>If dont see any USB serial ports listed in "Device Manager" under "Ports (COM &amp; LPT)", then make sure you have installed the UART to USB driver from Silicon labs,<a href="https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers">https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers</a>.</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="sk_ccs_uart_identify.png"]{width:60%}</style> </p><div class="image">
<img src="sk_ccs_uart_identify.png" alt=""/>
<div class="caption">
Identify UART Port in Windows Device Manager</div></div>
<ul>
<li>In CCS, goto "View &gt; Terminal"</li>
</ul>
<p> <style>div.image img[src="ccs_uart_00.png"]{width:20%}</style> </p><div class="image">
<img src="ccs_uart_00.png" alt=""/>
<div class="caption">
UART Terminal Menu</div></div>
<ul>
<li>Open a new UART terminal</li>
</ul>
<p> <style>div.image img[src="ccs_uart_01.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_uart_01.png" alt=""/>
<div class="caption">
Open New UART Terminal</div></div>
<ul>
<li>Select the UART port, keep other options to default, i.e 115200 baud rate - 8 data bits - No parity - 1 stop bit,<ul>
<li>We use the 2nd USB serial port, as seen in the device manager, for below in the SDK<ul>
<li>Flashing application via UART</li>
<li>Booting application via UART</li>
<li>Console output for examples which run from R5F</li>
</ul>
</li>
<li>We use the 1st USB serial port, as seen in the device manager, as terminal output for examples which run from M4F</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="sk_ccs_uart_02.png"]{width:25%}</style> </p><div class="image">
<img src="sk_ccs_uart_02.png" alt=""/>
<div class="caption">
Connect to UART port</div></div>
<ul>
<li>In this screenshot this happens to be COM5 and COM6 however on your machine this could be different. One tip to make sure there is no mistake in identifying the UART port is to disconnect all other UART to USB devices other than this AM64X-SK before checking in device manager.</li>
</ul>
<h1><a class="anchor" id="EVM_FLASH_SOC_INIT"></a>
Flash SOC Initialization Binary</h1>
<h2><a class="anchor" id="autotoc_md32"></a>
AM64X-EVM</h2>
<dl class="section attention"><dt>Attention</dt><dd>This is a recommended one time step that needs to be done before you can load and run programs via CCS</dd>
<dd>
If this step fails, maybe due to bad flash in EVM, then try one of the other SOC initialization steps mentioned at <a class="el" href="EVM_SETUP_PAGE.html#EVM_SOC_INIT">SOC Initialization</a></dd>
<dd>
This step needs to be done once unless the OSPI flash has been erased or some other application has been flashed</dd></dl>
<ul>
<li>A quick recap of steps done so far that are needed for the flashing to work<ul>
<li>Make sure the UART port used for terminal is identified as mentioned in <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a></li>
<li>Make sure python3 is installed as mentioned in <a class="el" href="SDK_DOWNLOAD_PAGE.html#INSTALL_PYTHON3">Python3</a></li>
<li>Make sure you have the EVM power cable and UART cable connected as shown in <a class="el" href="EVM_SETUP_PAGE.html#EVM_CABLES">Cable Connections</a></li>
</ul>
</li>
<li><b>POWER-OFF</b> the EVM</li>
<li>Set boot mode to UART BOOTMODE as shown in below image</li>
</ul>
<p> <style>div.image img[src="boot_pins_uart_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_uart_mode.png" alt=""/>
<div class="caption">
UART BOOT MODE</div></div>
<ul>
<li><b>POWER-ON</b> the EVM</li>
<li>You should see character "C" getting printed on the UART terminal every 2-3 seconds as shown below</li>
</ul>
<p> <style>div.image img[src="uart_rom_boot.png"]{width:80%}</style> </p><div class="image">
<img src="uart_rom_boot.png" alt=""/>
<div class="caption">
UART output in UART BOOT MODE</div></div>
<ul>
<li>Close the UART terminal as shown below. This is important, else the UART script in next step wont be able to connect to the UART port.</li>
</ul>
<p> <style>div.image img[src="ccs_uart_close.png"]{width:80%}</style> </p><div class="image">
<img src="ccs_uart_close.png" alt=""/>
<div class="caption">
Close UART terminal</div></div>
<ul>
<li>Open a command prompt and run the below command to flash the SOC initialization binary to the EVM. <pre class="fragment">  cd ${SDK_INSTALL_PATH}/tools/boot
  python uart_uniflash.py -p COM&lt;x&gt; --cfg=sbl_prebuilt/am64x-evm/default_sbl_null.cfg
</pre><ul>
<li>Here COM&lt;x&gt; is the port name of the identified UART port in Windows.</li>
<li>On Linux,<ul>
<li>The name for UART port is typically something like <code>/dev/ttyUSB0</code></li>
<li>On some Linux systems, one needs to use <code>python3</code> to invoke python3.x, just <code>python</code> command may invoke python 2.x which will not work with the flashing script.</li>
</ul>
</li>
</ul>
</li>
<li>When the flashing is in progress you will see something like below <pre class="fragment">  C:\ti\mcu_plus_sdk_am64x_09_00_00_00\tools\boot&gt;python uart_uniflash.py -p COM13 --cfg=sbl_prebuilt\am64x-evm\default_sbl_null.cfg

  Parsing config file ...
  Parsing config file ... SUCCESS. Found 2 command(s) !

  Executing command 1 of 2 ...
  Found flash writer ... sending sbl prebuilt/am64x-evm/sbl_uart_uniflash.hs_fs.tiimage
  Sending sbl_prebuilt/am64x-evm/sbl_uart_uniflash.release.hs_fs.tiimage: 24% ||||   | 58653/244220 [00:07&lt;00:17, 10706.64bytes/s],
</pre></li>
<li>After all the flashing is done, you will see something like below <pre class="fragment">  Parsing config file ...
  Parsing config file ... SUCCESS. Found 2 command(s) !

  Executing command 1 of 2 ...
  Found flash writer ... sending sbl_prebuilt/am64x-evm/sbl_uart_uniflash.release.hs_fs.tiimage
  Sent flashwriter sbl_prebuilt/am64x-evm/sbl_uart_uniflash.release.hs_fs.tiimage of size 244220 bytes in 24.84s.

  Executing command 2 of 2
  Command arguments : -—file=sbl _prebuilt/am64x-evm/sbl null.release.hs_fs.tiimage --operation=flash --flash-offset=0x0
  Sent sbl_prebuilt/am64x-evm/sbl_null.release.hs_fs.tiimage of size 231036 bytes in 24.06s.

  [STATUS] SUCCESS

  All commands from config file are executed !
</pre></li>
<li>If flashing has failed, see <a class="el" href="TOOLS_FLASH.html#TOOLS_FLASH_ERROR_MESSAGES">Flash tool error messages and solutions</a>, and resolve the errors.</li>
<li>If flashing is successful, do the next steps ...</li>
<li><b>POWER-OFF</b> the EVM</li>
<li>Switch the EVM boot mode to OSPI mode as shown below,</li>
</ul>
<p> <style>div.image img[src="boot_pins_ospi_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_ospi_mode.png" alt=""/>
<div class="caption">
OSPI BOOT MODE</div></div>
<ul>
<li>Re-connect the UART terminal in CCS window as shown in <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a></li>
<li><b>POWER-ON</b> the EVM</li>
<li>You should see output like below on the UART terminal <pre class="fragment">  Starting NULL Bootloader ...

  DMSC Firmware Version 21.1.1--v2021.01a (Terrific Lla
  DMSC Firmware revision 0x15
  DMSC ABI revision 3.1

  INFO: Bootloader_runCpu:151: CPU r5f1-0  is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:151: CPU r5f1-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:151: CPU m4f0-0 is initialized to 400000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:203: CPU r5f0-0 is initialized to 800000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:203: CPU r5f0-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runSelfCpu:215: All done, reseting self ...
</pre></li>
<li>Congratulations now the EVM is setup for loading and running from CCS !!!</li>
<li>You dont need to do these steps again unless you have flashed some other binary to the flash.</li>
<li>Now you can build a example of interest (see <a class="el" href="GETTING_STARTED_BUILD.html">Build a Hello World example</a>) and then run it (see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a>)</li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>If SBL NULL is used for development, GEL files aren't required for R5FSS0-0 and A53SS0-0 they can be replaced by GELs of other R5/A53 cores. Steps are given below</dd></dl>
<ul>
<li>In the CCS target configuration CCXML file, under Advanced tab, select, <code>MAIN_Cortex_R5_0_0</code>.</li>
<li>Under Cpu Properties, there should be an option <b>Initialization script</b> which should have a value <code>../../emulation/gel/AM64x/AM64_DDRSS/AM64_GP_EVM.gel</code></li>
<li>Click on browse and select the CPU reset gel, which should be under <code>&lt;CCS_DIR&gt;/ccs/ccs_base/emulation/gel/AM64x/CPU_reset.gel</code></li>
<li>And for A53SS0-0. In the CCS target configuration CCXML file, under Advanced tab, select, <code>ComputeCluster_A53_0</code>.</li>
<li>Under Cpu Properties, there should be an option <b>Initialization script</b> which should have a value <code>../../emulation/gel/AM64x/AM64_DDRSS/AM64_GP_EVM.gel</code></li>
<li>This field needs to be cleared for <code>ComputeCluster_A53_0</code> when using <b>SBL NULL</b></li>
<li>Save the target configuration file.</li>
</ul>
<h2><a class="anchor" id="autotoc_md33"></a>
AM64X-SK</h2>
<dl class="section attention"><dt>Attention</dt><dd>This is a recommended one time step that needs to be done before you can load and run programs via CCS</dd>
<dd>
If this step fails, maybe due to bad flash in AM64X-SK, then try one of the other SOC initialization steps mentioned at <a class="el" href="EVM_SETUP_PAGE.html#EVM_SOC_INIT">SOC Initialization</a></dd>
<dd>
This step needs to be done once unless the OSPI flash has been erased or some other application has been flashed</dd></dl>
<ul>
<li>A quick recap of steps done so far that are needed for the flashing to work<ul>
<li>Make sure the UART port used for terminal is identified as mentioned in <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a></li>
<li>Make sure python3 is installed as mentioned in <a class="el" href="SDK_DOWNLOAD_PAGE.html#INSTALL_PYTHON3">Python3</a></li>
<li>Make sure you have the EVM power cable and UART cable connected as shown in <a class="el" href="EVM_SETUP_PAGE.html#EVM_CABLES">Cable Connections</a></li>
</ul>
</li>
<li><b>POWER-OFF</b> the AM64X-SK</li>
<li>Set boot mode to UART BOOTMODE as shown in below image</li>
</ul>
<p> <style>div.image img[src="sk_boot_pins_uart_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_uart_mode.png" alt=""/>
<div class="caption">
UART BOOT MODE</div></div>
<ul>
<li><b>POWER-ON</b> the EVM</li>
<li>You should see character "C" getting printed on the UART terminal every 2-3 seconds as shown below</li>
</ul>
<p> <style>div.image img[src="uart_rom_boot.png"]{width:80%}</style> </p><div class="image">
<img src="uart_rom_boot.png" alt=""/>
<div class="caption">
UART output in UART BOOT MODE</div></div>
<ul>
<li>Close the UART terminal as shown below. This is important, else the UART script in next step wont be able to connect to the UART port.</li>
</ul>
<p> <style>div.image img[src="ccs_uart_close.png"]{width:80%}</style> </p><div class="image">
<img src="ccs_uart_close.png" alt=""/>
<div class="caption">
Close UART terminal</div></div>
<ul>
<li>Open a command prompt and run the below command to flash the SOC initialization binary to the SK. <pre class="fragment">  cd ${SDK_INSTALL_PATH}/tools/boot
  python uart_uniflash.py -p COM&lt;x&gt; --cfg=sbl_prebuilt/am64x-sk/default_sbl_null.cfg
</pre><ul>
<li>Here COM&lt;x&gt; is the port name of the identified UART port in Windows.</li>
<li>On Linux,<ul>
<li>The name for UART port is typically something like <code>/dev/ttyUSB0</code></li>
<li>On some Linux systems, one needs to use <code>python3</code> to invoke python3.x, just <code>python</code> command may invoke python 2.x which will not work with the flashing script.</li>
</ul>
</li>
</ul>
</li>
<li>When the flashing is in progress you will see something like below <pre class="fragment">  C:\ti\mcu_plus_sdk_am64x_09_00_00_00\tools\boot&gt;python uart_uniflash.py -p COM13 --cfg=sbl_prebuilt\am64x-sk\default_sbl_null.cfg

  Parsing config file ...
  Parsing config file ... SUCCESS. Found 2 command(s) !

  Executing command 1 of 2 ...
  Found flash writer ... sending sbl prebuilt/am64x-sk/sbl_uart_uniflash.hs_fs.tiimage
  Sending sbl_prebuilt/am64x-sk/sbl_uart_uniflash.release.hs_fs.tiimage: 24% ||||   | 58653/244220 [00:07&lt;00:17, 10706.64bytes/s],
</pre></li>
<li>After all the flashing is done, you will see something like below <pre class="fragment">  Parsing config file ...
  Parsing config file ... SUCCESS. Found 2 command(s) !

  Executing command 1 of 2 ...
  Found flash writer ... sending sbl_prebuilt/am64x-sk/sbl_uart_uniflash.release.hs_fs.tiimage
  Sent flashwriter sbl_prebuilt/am64x-sk/sbl_uart_uniflash.release.hs_fs.tiimage of size 244220 bytes in 24.84s.

  Executing command 2 of 2
  Command arguments : -—file=sbl _prebuilt/am64x-sk/sbl null.release.hs_fs.tiimage --operation=flash --flash-offset=0x0
  Sent sbl_prebuilt/am64x-sk/sbl_null.release.hs_fs.tiimage of size 231036 bytes in 24.06s.

  [STATUS] SUCCESS

  All commands from config file are executed !
</pre></li>
<li>If flashing has failed, see <a class="el" href="TOOLS_FLASH.html#TOOLS_FLASH_ERROR_MESSAGES">Flash tool error messages and solutions</a>, and resolve the errors.</li>
<li>If flashing is successful, do the next steps ...</li>
<li><b>POWER-OFF</b> the AM64X-SK</li>
<li>Switch the SK boot mode to OSPI mode as shown below,</li>
</ul>
<p> <style>div.image img[src="sk_boot_pins_ospi_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_ospi_mode.png" alt=""/>
<div class="caption">
OSPI BOOT MODE</div></div>
<ul>
<li>Re-connect the UART terminal in CCS window as shown in <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a></li>
<li><b>POWER-ON</b> the AM64X-SK</li>
<li>You should see output like below on the UART terminal <pre class="fragment">  Starting NULL Bootloader ...

  DMSC Firmware Version 22.1.1--v2022.01 (Terrific Llam
  DMSC Firmware revision 0x16
  DMSC ABI revision 3.1

  INFO: Bootloader_runCpu:150: CPU r5f1-0  is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU r5f1-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU m4f0-0 is initialized to 400000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU a530-0 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU a530-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:202: CPU r5f0-0 is initialized to 800000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:202: CPU r5f0-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runSelfCpu:219: All done, reseting self ...
</pre></li>
<li>Congratulations now the AM64X-SK is setup for loading and running from CCS !!!</li>
<li>You dont need to do these steps again unless you have flashed some other binary to the flash.</li>
<li>Now you can build a example of interest (see <a class="el" href="GETTING_STARTED_BUILD.html">Build a Hello World example</a>) and then run it (see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a>)</li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>If SBL NULL is used for development, GEL files aren't required for R5FSS0-0 and A53SS0-0 they can be replaced by GELs of other R5/A53 cores. Steps are given below</dd></dl>
<ul>
<li>In the CCS target configuration CCXML file, under Advanced tab, select, <code>MAIN_Cortex_R5_0_0</code>.</li>
<li>Under Cpu Properties, there should be an option <b>Initialization script</b> which should have a value <code>../../emulation/gel/AM64x/AM64_DDRSS/AM64_SK_EVM.gel</code></li>
<li>Click on browse and select the CPU reset gel, which should be under <code>&lt;CCS_DIR&gt;/ccs/ccs_base/emulation/gel/AM64x/CPU_reset.gel</code></li>
<li>And for A53SS0-0. In the CCS target configuration CCXML file, under Advanced tab, select, <code>ComputeCluster_A53_0</code>.</li>
<li>Under Cpu Properties, there should be an option <b>Initialization script</b> which should have a value <code>../../emulation/gel/AM64x/AM64_DDRSS/AM64_SK_EVM.gel</code></li>
<li>This field needs to be cleared for <code>ComputeCluster_A53_0</code> when using <b>SBL NULL</b></li>
<li>Save the target configuration file.</li>
</ul>
<h1><a class="anchor" id="autotoc_md34"></a>
Additional Details</h1>
<dl class="section note"><dt>Note</dt><dd>This section has more details on AM64X-EVM. This is mainly for reference and can be skiped unless referred to by other pages in this user guide.</dd></dl>
<h2><a class="anchor" id="EVM_SOC_INIT"></a>
SOC Initialization</h2>
<p>Before any program can be loaded and run on the EVM, the SOC needs to be initialized. Below sections describes the various options available for SOC initialization.</p>
<p>It is recommended to use the method mentioned in <a class="el" href="EVM_SETUP_PAGE.html#EVM_FLASH_SOC_INIT">Flash SOC Initialization Binary</a>. However in some cases, additional methods described below can be used esp when running on your own custom EVM and flash driver is not yet available for that EVM.</p>
<h3><a class="anchor" id="EVM_SOC_INIT_SD_BOOT_MODE"></a>
SOC Initialization Using SD BOOT</h3>
<h4><a class="anchor" id="autotoc_md35"></a>
AM64X-EVM</h4>
<dl class="section note"><dt>Note</dt><dd>This step needs to be done once, unless the SD card is reformatted and/or the boot file is changed</dd></dl>
<ul>
<li>Format a micro-SD card to contain a FAT partition as the primary partition</li>
<li>In windows,<ul>
<li>Insert a micro-SD in a USB card reader, connect to the PC.</li>
<li>In "Windows Explorer", select the SD drive, right-click, select "Format"  <style>div.image img[src="format_sd_card_00.png"]{width:20%}</style> <div class="image">
<img src="format_sd_card_00.png" alt=""/>
<div class="caption">
Format SD Card</div></div>
</li>
<li>Format as FAT filesystem  <style>div.image img[src="format_sd_card_01.png"]{width:20%}</style> <div class="image">
<img src="format_sd_card_01.png" alt=""/>
<div class="caption">
Format as FAT partition</div></div>
</li>
<li>After formatting is done, you need to mark the partition as "ACTIVE".<ul>
<li>There are various ways to do this in Windows, see online forums for various options</li>
<li>Here we use the GUI tool "Active Partition Manager" <a href="http://www.pcdisk.com/index.html">http://www.pcdisk.com/index.html</a><ul>
<li>Download and install the tool</li>
<li>Launch the tool and select "Open Disk Image"</li>
<li>You will see all the disks present on the system, including the SD card FAT partition</li>
<li>Right click on the SD card FAT partition</li>
<li>Select "Change Attributes"</li>
<li>Enable the option "Mark Partition As Active", click "OK"</li>
<li>Close the application</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>In Linux,<ul>
<li>Refer to online forums to create FAT partition on a SD card and set it as "ACTIVE"</li>
<li><code>gparted</code> is one GUI based tool that can be used to create partitions, format them and set them as "ACTIVE" <pre class="fragment">sudo apt install gparted
</pre></li>
</ul>
</li>
<li>Copy the below file to the newly formatted FAT partition on the SD card and <b>rename</b> it as <code>tiboot3.bin</code> <pre class="fragment">  copy file to SD card =&gt; ${SDK_INSTALL_PATH}/tools/boot/sbl_prebuilt/am64x-evm/sbl_null.release.hs_fs.tiimage
  rename in SD card as =&gt; tiboot3.bin
</pre></li>
<li>Eject the SD card</li>
<li><b>POWER-OFF</b> the EVM</li>
<li>Set EVM to SD BOOT MODE by setting the switch setting as shown below</li>
</ul>
<p> <style>div.image img[src="boot_pins_sd_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_sd_mode.png" alt=""/>
<div class="caption">
SD BOOT MODE</div></div>
<ul>
<li>Insert the formated SD card in the SD card slot in the EVM</li>
<li>Open a UART terminal as mentioned in <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a></li>
<li><b>POWER-ON</b> the EVM</li>
<li>You should see output like below on the UART terminal <pre class="fragment">  Starting NULL Bootloader ...

  DMSC Firmware Version 21.1.1--v2021.01a (Terrific Lla
  DMSC Firmware revision 0x15
  DMSC ABI revision 3.1

  INFO: Bootloader_runCpu:151: CPU r5f1-0  is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:151: CPU r5f1-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:151: CPU m4f0-0 is initialized to 400000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:203: CPU r5f0-0 is initialized to 800000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:203: CPU r5f0-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runSelfCpu:215: All done, reseting self ...
</pre></li>
<li>Congratulations now the EVM is setup for loading and running from CCS !!!</li>
<li>You dont need to do these steps again unless you have changed or re-formatted or deleted/changed the <code>tiboot3.bin</code> file.</li>
</ul>
<h4><a class="anchor" id="autotoc_md36"></a>
AM64X-SK</h4>
<dl class="section note"><dt>Note</dt><dd>This step needs to be done once, unless the SD card is reformatted and/or the boot file is changed</dd></dl>
<ul>
<li>Format a micro-SD card to contain a FAT partition as the primary partition</li>
<li>In windows,<ul>
<li>Insert a micro-SD in a USB card reader, connect to the PC.</li>
<li>In "Windows Explorer", select the SD drive, right-click, select "Format"  <style>div.image img[src="format_sd_card_00.png"]{width:20%}</style> <div class="image">
<img src="format_sd_card_00.png" alt=""/>
<div class="caption">
Format SD Card</div></div>
</li>
<li>Format as FAT filesystem  <style>div.image img[src="format_sd_card_01.png"]{width:20%}</style> <div class="image">
<img src="format_sd_card_01.png" alt=""/>
<div class="caption">
Format as FAT partition</div></div>
</li>
<li>After formatting is done, you need to mark the partition as "ACTIVE".<ul>
<li>There are various ways to do this in Windows, see online forums for various options</li>
<li>Here we use the GUI tool "Active Partition Manager" <a href="http://www.pcdisk.com/index.html">http://www.pcdisk.com/index.html</a><ul>
<li>Download and install the tool</li>
<li>Launch the tool and select "Open Disk Image"</li>
<li>You will see all the disks present on the system, including the SD card FAT partition</li>
<li>Right click on the SD card FAT partition</li>
<li>Select "Change Attributes"</li>
<li>Enable the option "Mark Partition As Active", click "OK"</li>
<li>Close the application</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>In Linux,<ul>
<li>Refer to online forums to create FAT partition on a SD card and set it as "ACTIVE"</li>
<li><code>gparted</code> is one GUI based tool that can be used to create partitions, format them and set them as "ACTIVE" <pre class="fragment">sudo apt install gparted
</pre></li>
</ul>
</li>
<li>Copy the below file to the newly formatted FAT partition on the SD card and <b>rename</b> it as <code>tiboot3.bin</code> <pre class="fragment">  copy file to SD card =&gt; ${SDK_INSTALL_PATH}/tools/boot/sbl_prebuilt/am64x-sk/sbl_null.release.hs_fs.tiimage
  rename in SD card as =&gt; tiboot3.bin
</pre></li>
<li>Eject the SD card</li>
<li><b>POWER-OFF</b> the AM64X-SK</li>
<li>Set EVM to SD BOOT MODE by setting the switch setting as shown below</li>
</ul>
<p> <style>div.image img[src="sk_boot_pins_sd_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_sd_mode.png" alt=""/>
<div class="caption">
SD BOOT MODE</div></div>
<ul>
<li>Insert the formated SD card in the SD card slot in the EVM</li>
<li>Open a UART terminal as mentioned in <a class="el" href="EVM_SETUP_PAGE.html#CCS_UART_TERMINAL">Setup UART Terminal</a></li>
<li><b>POWER-ON</b> the AM64X-SK</li>
<li>You should see output like below on the UART terminal <pre class="fragment">  Starting NULL Bootloader ...

  DMSC Firmware Version 22.1.1--v2022.01 (Terrific Llam
  DMSC Firmware revision 0x16
  DMSC ABI revision 3.1

  INFO: Bootloader_runCpu:150: CPU r5f1-0  is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU r5f1-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU m4f0-0 is initialized to 400000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU a530-0 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runCpu:150: CPU a530-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:202: CPU r5f0-0 is initialized to 800000000 Hz !!!
  INFO: Bootloader_loadSelfCpu:202: CPU r5f0-1 is initialized to 800000000 Hz !!!
  INFO: Bootloader_runSelfCpu:219: All done, reseting self ...
</pre></li>
<li>Congratulations now the EVM is setup for loading and running from CCS !!!</li>
<li>You dont need to do these steps again unless you have changed or re-formatted or deleted/changed the <code>tiboot3.bin</code> file.</li>
</ul>
<h3><a class="anchor" id="EVM_SOC_INIT_NOBOOT_MODE"></a>
SOC Initialization Using CCS Scripting</h3>
<h4><a class="anchor" id="autotoc_md37"></a>
Set Environment Variable</h4>
<dl class="section note"><dt>Note</dt><dd>This step needs to be done once and is needed for the SOC initialization script <code>load_dmsc_hsfs.js</code> to find certain initialization files within the SDK folder. This variable is not used otherwise in the build process. If you dont like adding variables in the environment, then you need to edit the file <code>${SDK_INSTALL_PATH}/tools/ccs_load/am64x/load_dmsc_hsfs.js</code> and specify the SDK path in the file itself.</dd></dl>
<ul>
<li>Add path to the SDK folder as a environment variable in the host machine.</li>
<li>In windows, goto "Windows Task Bar Search" and search for "environment variables for your account"  <style>div.image img[src="ccs_setup_03.png"]{width:15%}</style> <div class="image">
<img src="ccs_setup_03.png" alt=""/>
<div class="caption">
Environment Variables For Your Account</div></div>
</li>
<li>Add a new variable named <code>MCU_PLUS_SDK_AM64X_PATH</code> and point it to the path where the SDK is installed</li>
</ul>
<p> <style>div.image img[src="ccs_setup_04.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_setup_04.png" alt=""/>
<div class="caption">
Add New Environment Variable For Your Account</div></div>
<ul>
<li>In Linux, usually you need to add a line as below in the ${HOME}/.bashrc,</li>
</ul>
<pre class="fragment">    export MCU_PLUS_SDK_AM64X_PATH=${HOME}/ti/mcu_plus_sdk_am64x_{sdk version}/
</pre><ul>
<li>If CCS is open, close and reopen CCS for the CCS to be able to see the updated environment variable</li>
</ul>
<h4><a class="anchor" id="autotoc_md38"></a>
Run the SOC Initialization Script</h4>
<h5>AM64X-EVM</h5>
<dl class="section attention"><dt>Attention</dt><dd>This step needs to be done <b>every time</b> the EVM is power-cycled.</dd></dl>
<ul>
<li><b>POWER-OFF</b> the EVM</li>
<li>Make sure below cables are connected as shown in <a class="el" href="EVM_SETUP_PAGE.html#EVM_CABLES">Cable Connections</a><ul>
<li>Power cable</li>
<li>JTAG cable</li>
</ul>
</li>
<li>Set EVM in DEV BOOT MODE mode as shown below  <style>div.image img[src="boot_pins_devboot_mode.png"]{width:30%}</style> <div class="image">
<img src="boot_pins_devboot_mode.png" alt=""/>
<div class="caption">
DEV BOOT MODE</div></div>
</li>
<li><b>POWER-ON</b> the EVM</li>
<li>Launch the target configuration created with <a class="el" href="CCS_SETUP_PAGE.html#CCS_NEW_TARGET_CONFIG">Create Target Configuration</a></li>
</ul>
<p> <style>div.image img[src="ccs_launch_00.png"]{width:40%}</style> </p><div class="image">
<img src="ccs_launch_00.png" alt=""/>
<div class="caption">
Launch Target Configuration</div></div>
<ul>
<li>You will see the AM64X target configuration in the "Debug" window as shown below</li>
</ul>
<p> <style>div.image img[src="ccs_launch_01.png"]{width:40%}</style> </p><div class="image">
<img src="ccs_launch_01.png" alt=""/>
<div class="caption">
Target Configuration After Launch</div></div>
<ul>
<li>Goto "CCS Toolbar &gt; View &gt; Scripting Console"</li>
<li>Type the below command in the scripting console and press "enter", to load DMSC FW and initialize the SOC<ul>
<li>In Windows, assuming the SDK is installed at <code>C:/ti/mcu_plus_sdk_{soc}_{sdk version}</code> <pre class="fragment">loadJSFile "C:/ti/mcu_plus_sdk_{soc}_{sdk version}/tools/ccs_load/am64x/load_dmsc_hsfs.js" (HS-FS device)
</pre></li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="ccs_load_dmsc_00.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_load_dmsc_00.png" alt=""/>
<div class="caption">
Scripting Console</div></div>
<ul>
<li>In Linux, run the same command, only the path would be a Linux path like <code>/home/{username}/ti/mcu_plus_sdk_{soc}_{sdk version}/tools/ccs_load/am64x/load_dmsc_hsfs.js</code></li>
<li>After successful execution of this script one would see logs as below<ul>
<li>In the scripting console, this is log from the script itself. <pre class="fragment">js:&gt; LoadJSFile "C:/ti/mcu_plus_sdk/tools/ccs_load/am64x/load_dmsc_hsfs.js"
Connecting to MCU Cortex_R5_0!
Writing While(1) for R5F
Running the board configuration initialization from R5!
Happy Debugging
</pre></li>
<li>In the AM64X "CIO" console, this is log from the R5F. <pre class="fragment">[MAIN_Cortex_R5_0_0]
DMSC Firmware Version AA.B.C-vDDDD.EEE-FF-gggggg (HHH
DMSC Firmware revision 0xNN
DMSC ABI revision x.y

[SCICLIENT] ABI check PASSED
[SCICLIENT] Board Configuration with Debug enabled ...
[SCICLIENT] Common Board Configuration PASSED
[SCICLIENT] PM Board Configuration PASSED
[SCICLIENT] RM Board Configuration PASSED
[SCICLIENT] Security Board Configuration PASSED

DMSC Firmware Version AA.B.C-vDDDD.EEE-FF-gggggg (HHH
DMSC Firmware revision 0xNN
DMSC ABI revision x.y

All tests have passed!!
</pre></li>
<li>In the AM64X console, this is log from the GEL scripts.  <style>div.image img[src="ccs_load_dmsc_03.png"]{width:50%}</style> <div class="image">
<img src="ccs_load_dmsc_03.png" alt=""/>
<div class="caption">
Select AM64X GEL Console</div></div>
</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="ccs_load_dmsc_04.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_load_dmsc_04.png" alt=""/>
<div class="caption">
AM64X Console GEL Log</div></div>
<ul>
<li>For success, all the three consoles should have no errors in their logs.</li>
<li>If the script is run without providing power to the EVM or if the EVM BOOTMODE is not set to <a class="el" href="EVM_SETUP_PAGE.html#BOOTMODE_NOBOOT">DEV BOOT MODE</a> then you will see errors in the console and/or unexpected behaviour and error messages.<ul>
<li><b>SOLUTION</b>: Power cycle EVM and repeat the steps.</li>
</ul>
</li>
</ul>
<h5>AM64X-SK</h5>
<dl class="section attention"><dt>Attention</dt><dd>This step needs to be done <b>every time</b> the EVM is power-cycled.</dd></dl>
<ul>
<li><b>POWER-OFF</b> the AM64X-SK</li>
<li>Make sure below cables are connected as shown in <a class="el" href="EVM_SETUP_PAGE.html#EVM_CABLES">Cable Connections</a><ul>
<li>Power cable</li>
<li>JTAG cable</li>
</ul>
</li>
<li>Set EVM in NOBOOT mode as shown below  <style>div.image img[src="sk_boot_pins_noboot_mode.png"]{width:30%}</style> <div class="image">
<img src="sk_boot_pins_noboot_mode.png" alt=""/>
<div class="caption">
NO BOOT MODE</div></div>
</li>
<li><b>POWER-ON</b> the AM64X-SK</li>
<li>Launch the target configuration created with <a class="el" href="CCS_SETUP_PAGE.html#CCS_NEW_TARGET_CONFIG">Create Target Configuration</a></li>
</ul>
<p> <style>div.image img[src="ccs_launch_00.png"]{width:40%}</style> </p><div class="image">
<img src="ccs_launch_00.png" alt=""/>
<div class="caption">
Launch Target Configuration</div></div>
<ul>
<li>You will see the AM64X target configuration in the "Debug" window as shown below</li>
</ul>
<p> <style>div.image img[src="ccs_launch_01.png"]{width:40%}</style> </p><div class="image">
<img src="ccs_launch_01.png" alt=""/>
<div class="caption">
Target Configuration After Launch</div></div>
<ul>
<li>Goto "CCS Toolbar &gt; View &gt; Scripting Console"</li>
<li>Type the below command in the scripting console and press "enter", to load DMSC FW and initialize the SOC<ul>
<li>In Windows, assuming the SDK is installed at <code>C:/ti/mcu_plus_sdk_{soc}_{sdk version}</code> <pre class="fragment">loadJSFile "C:/ti/mcu_plus_sdk_{soc}_{sdk version}/tools/ccs_load/am64x/load_dmsc_hsfs.js"
</pre></li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="ccs_load_dmsc_00.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_load_dmsc_00.png" alt=""/>
<div class="caption">
Scripting Console</div></div>
<ul>
<li>In Linux, run the same command, only the path would be a Linux path like <code>/home/{username}/ti/mcu_plus_sdk_{soc}_{sdk version}/tools/ccs_load/am64x/load_dmsc_hsfs.js</code></li>
<li>After successful execution of this script one would see logs as below<ul>
<li>In the scripting console, this is log from the script itself. <pre class="fragment">js:&gt; LoadJSFile "C:/ti/mcu_plus_sdk/tools/ccs_load/am243x/load_dmsc_hsfs.js"
Connecting to MCU Cortex_R5_0!
Writing While(1) for R5F
Running the board configuration initialization from R5!
Happy Debugging
</pre></li>
<li>In the AM64X "CIO" console, this is log from the R5F. <pre class="fragment">[MAIN_Cortex_R5_0_0]
DMSC Firmware Version AA.B.C-vDDDD.EEE-FF-gggggg (HHH
DMSC Firmware revision 0xNN
DMSC ABI revision x.y

[SCICLIENT] ABI check PASSED
[SCICLIENT] Board Configuration with Debug enabled ...
[SCICLIENT] Common Board Configuration PASSED
[SCICLIENT] PM Board Configuration PASSED
[SCICLIENT] RM Board Configuration PASSED
[SCICLIENT] Security Board Configuration PASSED

DMSC Firmware Version AA.B.C-vDDDD.EEE-FF-gggggg (HHH
DMSC Firmware revision 0xNN
DMSC ABI revision x.y

All tests have passed!!
</pre></li>
<li>In the AM64X console, this is log from the GEL scripts.  <style>div.image img[src="ccs_load_dmsc_03.png"]{width:50%}</style> <div class="image">
<img src="ccs_load_dmsc_03.png" alt=""/>
<div class="caption">
Select AM64X GEL Console</div></div>
</li>
</ul>
</li>
</ul>
<p> <style>div.image img[src="ccs_load_dmsc_04.png"]{width:50%}</style> </p><div class="image">
<img src="ccs_load_dmsc_04.png" alt=""/>
<div class="caption">
AM64X Console GEL Log</div></div>
<ul>
<li>For success, all the three consoles should have no errors in their logs.</li>
<li>If the script is run without providing power to the AM64X-SK or if the AM64X-SK BOOTMODE is not set to <a class="el" href="EVM_SETUP_PAGE.html#BOOTMODE_NOBOOT">DEV BOOT MODE</a> then you will see errors in the console and/or unexpected behaviour and error messages.<ul>
<li><b>SOLUTION</b>: Power cycle AM64X-SK and repeat the steps.</li>
</ul>
</li>
</ul>
<h4><a class="anchor" id="DDR_INIT"></a>
DDR Initialization</h4>
<ul>
<li>To initialize DDR, do the additional step below from CCS GEL menu.</li>
<li>Launch CCS debug session as mentioned here, <a class="el" href="CCS_LAUNCH_PAGE.html#CCS_LAUNCH">Launch CCS</a></li>
<li>Connect to <code>MAIN_Cortex_R5_0_0</code></li>
</ul>
<p> <style>div.image img[src="ccs_load_run_00.png"]{width:60%}</style> </p><div class="image">
<img src="ccs_load_run_00.png" alt=""/>
<div class="caption">
Connect to R5F0-0</div></div>
<ul>
<li>Run the DDR initialization from GEL menu as shown below,</li>
</ul>
<p> <style>div.image img[src="ddr_init.png"]{width:60%}</style> </p><div class="image">
<img src="ddr_init.png" alt=""/>
<div class="caption">
DDR initialization via GEL menu</div></div>
<ul>
<li>After the DDR initialization is done you will see prints like below in the CCS "CIO" console, <pre class="fragment">  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR4 Initialization is in progress ... &lt;&lt;&lt;---
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; ECC Disabled &lt;&lt;&lt;---
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR controller programming in progress.. &lt;&lt;&lt;---
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR controller programming completed... &lt;&lt;&lt;---
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR PI programming in progress.. &lt;&lt;&lt;---
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR PI programming completed... &lt;&lt;&lt;---
  ...
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR Initialization completed... &lt;&lt;&lt;---
  MAIN_Cortex_R5_0_0: GEL Output: ---&gt;&gt;&gt; DDR4 Initialization is DONE! &lt;&lt;&lt;---
</pre></li>
<li>Now you can load programs to DDR and they can access DDR. Note, however for R5F and M4F to access DDR, there needs to be a MPU region setup to cover the DDR memory. By default, most SDK examples dont setup this MPU region. Also all code that executes before this MPU region is setup MUST NOT execute from DDR.</li>
</ul>
<h2><a class="anchor" id="autotoc_md39"></a>
BOOT MODE</h2>
<h3><a class="anchor" id="BOOTMODE_UART"></a>
UART BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md40"></a>
AM64X-EVM</h4>
<p>This mode is used to flash files to the EVM flash via UART. It can also be used to boot applications via UART. </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 1101 1100</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 1011 0000</div>
</div><!-- fragment --><p> <style>div.image img[src="boot_pins_uart_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_uart_mode.png" alt=""/>
<div class="caption">
UART BOOT MODE</div></div>
<h4><a class="anchor" id="autotoc_md41"></a>
AM64X-SK</h4>
<p>This mode is used to flash files to the AM64X-SK flash via UART. It can also be used to boot applications via UART. </p><div class="fragment"><div class="line">BOOTMODE [ 15 : 8 ] (SW2) = 0000 1101</div>
<div class="line">BOOTMODE [  7 : 0 ] (SW3) = 0011 1011</div>
</div><!-- fragment --><p> <style>div.image img[src="sk_boot_pins_uart_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_uart_mode.png" alt=""/>
<div class="caption">
UART BOOT MODE</div></div>
<h3><a class="anchor" id="BOOTMODE_DFU"></a>
DFU BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md42"></a>
AM64x-EVM</h4>
<p>This mode is used to flash files to the EVM flash via USB2.0 DFU. It can also be used to boot applications via USB2.0 DFU. </p><pre class="fragment">\code
BOOTMODE [ 0 :  7 ] (SW2) = 1100 1010
BOOTMODE [ 8 : 15 ] (SW3) = 0000 0000
\endcode
</pre><p> <style>div.image img[src="bootpins-dfu-evm.jpg"]{width:30%}</style> </p><div class="image">
<img src="bootpins-dfu-evm.jpg" alt=""/>
<div class="caption">
DFU BOOT MODE</div></div>
<h3><a class="anchor" id="BOOTMODE_OSPI"></a>
OSPI BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md43"></a>
AM64X-EVM</h4>
<p>This mode is used to boot flashed applications via EVM flash like OSPI flash </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 1100 1110</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 0100 0000</div>
</div><!-- fragment --><p> <style>div.image img[src="boot_pins_ospi_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_ospi_mode.png" alt=""/>
<div class="caption">
OSPI BOOT MODE</div></div>
<h4><a class="anchor" id="autotoc_md44"></a>
AM64X-SK</h4>
<p>This mode is used to boot flashed applications via AM64X-SK flash like OSPI flash </p><div class="fragment"><div class="line">BOOTMODE [ 15 : 8 ] (SW2) = 0000 0010</div>
<div class="line">BOOTMODE [  7 : 0 ] (SW3) = 0111 0011</div>
</div><!-- fragment --><p> <style>div.image img[src="sk_boot_pins_ospi_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_ospi_mode.png" alt=""/>
<div class="caption">
OSPI BOOT MODE</div></div>
<h3><a class="anchor" id="BOOTMODE_SD"></a>
SD BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md45"></a>
AM64X-EVM</h4>
<p>This mode is used to boot applications via SD card on the EVM. </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 1100 0011</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 0110 1100</div>
</div><!-- fragment --><p> <style>div.image img[src="boot_pins_sd_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_sd_mode.png" alt=""/>
<div class="caption">
SD BOOT MODE</div></div>
<h4><a class="anchor" id="autotoc_md46"></a>
AM64X-SK</h4>
<p>This mode is used to boot applications via SD card on the AM64X-SK. </p><div class="fragment"><div class="line">BOOTMODE [ 15 :  8 ] (SW2) = 0011 0110</div>
<div class="line">BOOTMODE [  7 :  0 ] (SW3) = 1100 0011</div>
</div><!-- fragment --><p> <style>div.image img[src="sk_boot_pins_sd_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_sd_mode.png" alt=""/>
<div class="caption">
SD BOOT MODE</div></div>
<h3><a class="anchor" id="BOOTMODE_NOBOOT"></a>
DEV BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md47"></a>
AM64X-EVM</h4>
<p>This mode is used in conjunction with the <code>load_dmsc_hsfs.js</code> script described here <a class="el" href="EVM_SETUP_PAGE.html#EVM_SOC_INIT_NOBOOT_MODE">SOC Initialization Using CCS Scripting</a>, </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 1101 1110</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 0000 0000</div>
</div><!-- fragment --><p> <style>div.image img[src="boot_pins_devboot_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_devboot_mode.png" alt=""/>
<div class="caption">
DEV BOOT MODE</div></div>
<h4><a class="anchor" id="autotoc_md48"></a>
AM64X-SK</h4>
<p>This mode is used in conjunction with the <code>load_dmsc.js</code> script described here <a class="el" href="EVM_SETUP_PAGE.html#EVM_SOC_INIT_NOBOOT_MODE">SOC Initialization Using CCS Scripting</a>, </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 0000 0000</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 1111 1011</div>
</div><!-- fragment --><p> <style>div.image img[src="sk_boot_pins_noboot_mode.png"]{width:30%}</style> </p><div class="image">
<img src="sk_boot_pins_noboot_mode.png" alt=""/>
<div class="caption">
NO BOOT MODE</div></div>
<h3><a class="anchor" id="BOOTMODE_EMMC"></a>
EMMC BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md49"></a>
AM64X-EVM</h4>
<p>This mode is used to boot applications via eMMC on the EVM. </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 1101 0010</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 0000 0000</div>
</div><!-- fragment --><p> <style>div.image img[src="boot_pins_emmc_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_emmc_mode.png" alt=""/>
<div class="caption">
EMMC BOOT MODE</div></div>
<h3><a class="anchor" id="BOOTMODE_PCIE"></a>
PCIE BOOT MODE</h3>
<h4><a class="anchor" id="autotoc_md50"></a>
AM64X-EVM</h4>
<p>This mode is used to boot applications via PCIe on the EVM. </p><div class="fragment"><div class="line">BOOTMODE [ 0 :  7 ] (SW2) = 1101 0110</div>
<div class="line">BOOTMODE [ 8 : 15 ] (SW3) = 0000 0000</div>
</div><!-- fragment --><p> <style>div.image img[src="boot_pins_pcie_mode.png"]{width:30%}</style> </p><div class="image">
<img src="boot_pins_pcie_mode.png" alt=""/>
<div class="caption">
PCIE BOOT MODE</div></div>
<h1><a class="anchor" id="TROUBLESHOOT_ISSUES"></a>
Troubleshooting EVM issues</h1>
<ul>
<li>JTAG connection fails on some EVMs with the following error. Need to connect the JTAG cable after board is powered on.</li>
</ul>
<p> <style>div.image img[src="jtag_connection_error.PNG"]{width:30%}</style> </p><div class="image">
<img src="jtag_connection_error.PNG" alt=""/>
<div class="caption">
JTAG Connection Error Dialog</div></div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
