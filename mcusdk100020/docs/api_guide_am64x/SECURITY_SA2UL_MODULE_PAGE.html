<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: SA2UL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('SECURITY_SA2UL_MODULE_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">SA2UL </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md2232">Features Supported In Hardware</a></li>
<li class="level1"><a href="#autotoc_md2233">Features Supported In Driver</a></li>
<li class="level1"><a href="#autotoc_md2234">Block diagram</a><ul><li class="level2"><a href="#autotoc_md2235">PSI-L</a></li>
<li class="level2"><a href="#autotoc_md2236">Context Cache</a></li>
<li class="level2"><a href="#autotoc_md2237">Encryption Engine</a></li>
<li class="level2"><a href="#autotoc_md2238">Authentication Engine</a></li>
<li class="level2"><a href="#autotoc_md2239">ECC Aggregator</a></li>
<li class="level2"><a href="#autotoc_md2240">CBASS</a></li>
<li class="level2"><a href="#autotoc_md2241">Context RAM</a></li>
<li class="level2"><a href="#autotoc_md2242">Packet RAM</a></li>
<li class="level2"><a href="#autotoc_md2243">TRNG</a></li>
<li class="level2"><a href="#autotoc_md2244">PKA</a></li>
</ul>
</li>
<li class="level1"><a href="#Dma_flow">DMA Flow</a></li>
<li class="level1"><a href="#autotoc_md2245">SysConfig Features</a></li>
<li class="level1"><a href="#autotoc_md2246">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md2247">Usage Overview</a><ul><li class="level2"><a href="#autotoc_md2248">Dependencies</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md2249">SA2UL API&#39;s Supported</a><ul><li class="level2"><a href="#autotoc_md2250">API Sequence for CBC abd ECB Algorithms</a></li>
<li class="level2"><a href="#autotoc_md2251">API Sequence for SHA Algorithms</a></li>
<li class="level2"><a href="#autotoc_md2252">API Sequence for HMAC-SHA Algorithms</a></li>
<li class="level2"><a href="#autotoc_md2253">API Sequence for AES-CMAC Algorithms</a></li>
<li class="level2"><a href="#autotoc_md2254">Opening the SA2UL Driver</a></li>
<li class="level2"><a href="#autotoc_md2255">Ultra lite Security Accelerator</a></li>
<li class="level2"><a href="#autotoc_md2256">AES (Advanced Encryption Standard)</a></li>
<li class="level2"><a href="#autotoc_md2257">SHA (Secure Hash Algorithm)</a></li>
<li class="level2"><a href="#autotoc_md2258">HMAC-SHA (Keyed-Hash Message Authentication Code Secure Hash Algorithm)</a></li>
<li class="level2"><a href="#autotoc_md2259">AES-CMAC (Cipher-based Message Authentication Code)</a></li>
<li class="level2"><a href="#autotoc_md2260">Closing the SA2UL Driver</a></li>
</ul>
</li>
<li class="level1"><a href="#Example_usage">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md2261">Directory Structure</a></li>
<li class="level1"><a href="#autotoc_md2262">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_security_crypto_sa2ul"></a></p>
<p>The SA2_UL subsystem is designed to provide a generic cryptographic acceleration for different use cases such as secure boot, secure content, key exchange etc.</p>
<h1><a class="anchor" id="autotoc_md2232"></a>
Features Supported In Hardware</h1>
<ul>
<li>Compatible with ARM Trustzone operations</li>
<li>Support non-secure authentication</li>
<li>Crypto function library for software acceleration<ul>
<li><b>AES</b> operation</li>
<li><b>SHA2-224, 256, 512 operation</b></li>
</ul>
</li>
<li>Block data encryption supported via hardware cores<ul>
<li><b>AES</b> with 128, 192 and 256 bits key support</li>
</ul>
</li>
<li>Data encryption modes support<ul>
<li><b>ECB</b> (Electronic code book)</li>
<li><b>CBC</b> (Cipher block chaining)</li>
<li><b>CFB</b> (Cipher feedback)</li>
<li><b>OFB</b> (Output feedback)</li>
<li><b>F8</b> (3GPP confidentiality and integrity algorithms)</li>
<li><b>CTR</b> (Counter)</li>
<li><b>CBC-MAC</b> (Cipher block chaining - Message authentication code)</li>
<li><b>CCM</b> (Counter with CBC-MAC)</li>
<li><b>GCM</b> (Galois counter mode)</li>
<li><b>GMAC</b> (Galois Message Authentication Code)</li>
</ul>
</li>
<li><b>Public Key accelerator</b> with Elliptic Curve Cryptography (ECC)<ul>
<li>High performance Public Key Accelerator (PKA) for large vector math operation</li>
</ul>
</li>
<li>Supports modulus size up to 4096-bits<ul>
<li>A dual <b>LNME</b> module for Montgomery multiplication and exponentiation</li>
<li>Prime field GF(p) <b>ECC</b> point addition, doubling and multiplication for all NIST (FIPS 186-3) recommended prime curves</li>
<li>Binary field GF(2m) ECC point addition, doubling and multiplication.</li>
<li>Support public key computations such as <b>RSA</b> (4k).</li>
<li>Single call operations for RSA up to 4k and ECC (Prime NIST curves) signing and verification</li>
<li>Supports Brainpool, NIST and Curve25519 ECC curves</li>
<li>Authentication supported via following hardware cores</li>
<li><b>SHA2-224</b></li>
<li><b>SHA2-256</b></li>
<li><b>SHA2-512</b></li>
</ul>
</li>
<li>Keyed <b>HMAC</b> operation via hardware core<ul>
<li><b>HMAC</b> using <b>SHA2-224</b>, <b>SHA2-256</b> and <b>SHA2-512</b></li>
<li>Support for truncated authentication tag</li>
</ul>
</li>
<li>True Random number generator (<b>TRNG</b>)<ul>
<li>True (not pseudo) random number generator</li>
<li>FIPS 140-1 compliant</li>
<li>Non-deterministic noise source for generating keys, IV etc</li>
</ul>
</li>
<li>Context cache module to auto fetch security context<ul>
<li>Cache limited number (up to 4) contexts for low cost</li>
<li>Auto-fetch security context based on current state of engine</li>
<li>Option to allow storage of security context within engine for high performance connections</li>
</ul>
</li>
<li>Auto evict security context based on unavailability of space within context cache</li>
<li>Fully pipelined engines for parallel processing</li>
<li><b>DMA</b> support for Cryptographic acceleration</li>
</ul>
<h1><a class="anchor" id="autotoc_md2233"></a>
Features Supported In Driver</h1>
<ul>
<li>Encryption and authentication</li>
<li>Crypto function library for Security acceleration<ul>
<li><b>S</b>ecure <b>h</b>ash <b>a</b>lgorithms<ul>
<li><b>SHA256</b>, <b>SHA512</b></li>
</ul>
</li>
<li><b>H</b>ash-based <b>m</b>essage <b>a</b>uthentication <b>c</b>ode<ul>
<li><b>HMAC SHA-256</b>, <b>HMAC SHA-512</b>, <b>HMAC SHA1</b></li>
</ul>
</li>
<li><b>A</b>dvanced <b>e</b>ncryption <b>s</b>tandard<ul>
<li><b>AES-CBC</b>(128/256)(<b>C</b>ipher <b>B</b>lock <b>C</b>haining)</li>
<li><b>AES-ECB</b>(128/256)(<b>E</b>lectronic <b>C</b>ode <b>B</b>ook)</li>
<li><b>AES-CMAC</b>(128/256)(<b>C</b>ipher-based <b>M</b>essage <b>A</b>uthentication <b>C</b>ode)</li>
</ul>
</li>
</ul>
</li>
<li>Supports random number generator(<b>RNG</b>)<ul>
<li>Keys and initialization values (<b>IV</b>s) for encryption</li>
<li>Keys for <b>keyed MAC</b> algorithms</li>
<li>Private keys for <b>digital signature algorithms</b></li>
<li>Values to be used in <b>entity authentication mechanisms</b></li>
<li><b>PIN</b> and <b>password</b> generation</li>
</ul>
</li>
<li>Supports public-key accelerator(<b>PKA</b>)<ul>
<li>Supports up to 4K bit key</li>
<li>Supports Raw operations</li>
<li>Supports PKA <b>RSA encryption and decryption</b></li>
<li>Supports <b>RSA signing and verification operations</b></li>
<li>Supports <b>ECDSA signing and verification operations</b><ul>
<li><b>P-256 and P-384 curves</b></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md2234"></a>
Block diagram</h1>
<dl class="section note"><dt>Note</dt><dd>This block diagram referred from Sa2ul functional specification.</dd></dl>
<p> <style>div.image img[src="security_crypto_block_diagram.png"]{width:60%}</style> </p><div class="image">
<img src="security_crypto_block_diagram.png" alt=""/>
<div class="caption">
Sa2ul block diagram</div></div>
<h2><a class="anchor" id="autotoc_md2235"></a>
PSI-L</h2>
<ul>
<li>The PSI-L(Packet Streaming Interface Link) is used to transfer words of packet data and control information between two peer entities via direct connection. There are credits used for flow control to guarantee that blocking does not occur between threads. Multiple packet transfers can be ongoing simultaneously across a PSI-L interface each on a separate logical thread but all sharing a single data path through time division multiplexing. Each packet which is transferred is accompanied by a destination thread ID which indicates the logical destination thread to which the packet is being sent.</li>
<li>SA2_UL accepts packets from <b>Streaming interface (PSI-L)</b> port with 8 ingress threads where each thread is a <b>UDMA Tx channel</b>. Each packet destined to SA2_UL must be prefixed with three extended packet info words (software words) that hold information about security context that is required to uniquely identify security connection and associated security parameters. The coherency is expected to be maintained by the <b>UDMA-P</b>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2236"></a>
Context Cache</h2>
<ul>
<li>Context cache fetch process involves two primary levels of security checks for the fetch to be successful. The first level of check is for SA2_UL to translate the security attributes from the incoming packets to the attributes on the <b>VBUSP DMA</b> host interface. The firewall IP near the external memory will then check these attributes before allowing access. The second level check is done after SA2_UL fetches and caches the context. SA2_UL compares the security attributes from the packets and the attributes stored inside the security context. If the attributes satisfy the check requirements, the context is used by the encryption and/or authentication engine, otherwise SA2_UL does not process the packet (packet will pass through) and a security exception will be generated.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2237"></a>
Encryption Engine</h2>
<ul>
<li>It carries out the task of encrypting/decrypting payload from desired offset using hardware encryption cryptographic cores. Encryption engine has AES core, 3DES core and Galois multiplier core which is operated in conjunction with MCE (mode control engine). Mode control engine implements various encryption modes like ECB, CBC, CTR, OFB, GCM etc.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2238"></a>
Authentication Engine</h2>
<ul>
<li>It caters the requirement of providing integrity protection. Authentication engine is equipped with SHA1 core, MD5 core, SHA2 core (up to 512 bits) to support keyed (HMAC) and non-keyed hash calculation.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2239"></a>
ECC Aggregator</h2>
<ul>
<li>To increase functional and system reliability the memories (for example, FIFOs, queues, SRAMs and others) in many device modules and subsystems are protected by error correcting code (ECC). This is accomplished through an ECC aggregator.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2240"></a>
CBASS</h2>
<ul>
<li>CBASS is the interconnection technique used to communicate between modules and subsystems in the device for any memory map accesses.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2241"></a>
Context RAM</h2>
<ul>
<li>Each engine/subsystem has a <b>Context RAM</b> to store the control information pertaining to the logical connection. The <b>context RAM</b> holds the information like Keys, IV, partial data etc. for each active context. The SA2_UL subsystem provides the option to store 4 contexts on-chip. <b>Context RAM</b> is coupled with <b>Context Cache</b> module to fetch the context information from external memory to populate the active context on real-time demand basis.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2242"></a>
Packet RAM</h2>
<ul>
<li>Packet RAM used to store Chunks of packets for processing sa2ul operations normally size of packet RAM is 2 banks (1KB or 2 chunks).</li>
</ul>
<h2><a class="anchor" id="autotoc_md2243"></a>
TRNG</h2>
<ul>
<li>TRNG (True Random number generator) used to create initialization vector required for certain encryption modes. The random numbers are accessible to the host in four 32-bit registers allowing 128-bit random number to be read with a single burst read.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2244"></a>
PKA</h2>
<ul>
<li>The PKA(Public Key Accelerator) module provides a high-performance public key engine to accelerate the large vector math processing that is required for Public Key computations. It also includes hw acceleration for Elliptic Curve Cryptography such as binary field ECC point addition, inversion, multiplication and ECC prime field point addition, inversion and multiplication.</li>
</ul>
<h1><a class="anchor" id="Dma_flow"></a>
DMA Flow</h1>
<ul>
<li>Sa2ul Uses PKTDMA, the PKTDMA module supports the transmission and reception of various packet types. The PKTDMA is architected to facilitate the segmentation and reassembly of KSLC DMA data structure compliant packets to/from smaller data blocks that are natively compatible with the specific requirements of each connected peripheral.</li>
</ul>
<p> <style>div.image img[src="sa2ul_dma_flow.png"]{width:60%}</style> </p><div class="image">
<img src="sa2ul_dma_flow.png" alt=""/>
<div class="caption">
sa2ul dma flow</div></div>
<h1><a class="anchor" id="autotoc_md2245"></a>
SysConfig Features</h1>
<ul>
<li>Select Crypto instance, it automatically create sa2ul and Dma with PKTDMA instances.</li>
<li>We can not create more then one instances due to Dma limitations.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2246"></a>
Features NOT Supported</h1>
<ul>
<li>Context fetch using the MMR is no longer supported to ensure data security.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2247"></a>
Usage Overview</h1>
<h2><a class="anchor" id="autotoc_md2248"></a>
Dependencies</h2>
<ul>
<li><a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> should be populated for intended cryptographic operation. Please see this <a class="el" href="SECURITY_SA2UL_MODULE_PAGE.html#Example_usage">Example Usage</a> for AES and SHA.</li>
<li>DMA initialization is required.</li>
<li>DMA Tx and Rx Channels need to be initialized. Please refer <a class="el" href="SECURITY_SA2UL_MODULE_PAGE.html#Dma_flow">DMA Flow</a>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2249"></a>
SA2UL API's Supported</h1>
<ul>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#gae15d14375610b71e0e4f23fe8e4aae4c" title="This function initializes the SA2UL module.">SA2UL_init()</a> : Initialize the SA2UL module.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga13cf37c705a3407dcda148e051daf4a4" title="Function to initialize default SA2UL parameters.">SA2UL_Params_init()</a> : Initialize a <a class="el" href="structSA2UL__Params.html" title="Parameters passed to SA2UL_open()">SA2UL_Params</a> structure with default values. Then change the parameters from non-default values as needed.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga5b6d1f5bcbc8a07ae61b0f6dde58c68c" title="This function opens a given SA2UL module.">SA2UL_open()</a> : Open an instance of the SA2UL module, enable Sa2ul hw engines and initialize dma.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a> : Function to configure secure context.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a> : Function to free secure context configuration.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> : Function to transfer and receive data buffer.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga63ff574ab3703d2f10c6433a439cb8f8" title="Function to close a SA2UL module specified by the SA2UL handle.">SA2UL_close()</a> : De-initialize the SA2UL instance, disable Sa2ul hw engines and de-initialize dma.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga1e872dce5d605ff48ba08df7c4428a4a" title="This function de-initializes the SA2UL module.">SA2UL_deinit()</a> : De-Initialize the SA2UL module.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2250"></a>
API Sequence for CBC abd ECB Algorithms</h2>
<p>This sequence performs Encryption and decryption operations for AES-CBC/ECB algorithms. Supported key lengths are 128 and 256 bit.</p>
<ul>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> : Initializes a Crypto context and Open an instance of the SA2UL module, enable Sa2ul hw engines and initialize dma.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a> : Function to configure secure context.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> : Function to transfer and receive data buffer.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a> : Function to free secure context configuration.</li>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a> : De-initialize the SA2UL instance, disable Sa2ul hw engines and de-initialize dma and clears context.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2251"></a>
API Sequence for SHA Algorithms</h2>
<p>This sequence performs SHA-512 and SHA-256.</p>
<ul>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> : Initializes a Crypto context and Open an instance of the SA2UL module, enable Sa2ul hw engines and initialize dma.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a> : Function to configure secure context.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> : Function to transfer and receive data buffer.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a> : Function to free secure context configuration.</li>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a> : De-initialize the SA2UL instance, disable Sa2ul hw engines and de-initialize dma and clears context.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2252"></a>
API Sequence for HMAC-SHA Algorithms</h2>
<p>This sequence performs HMAC SHA-512, SHA-256 and SHA1.</p>
<ul>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> : Initializes a Crypto context and Open an instance of the SA2UL module, enable Sa2ul hw engines and initialize dma.</li>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#gad224127ab228a0206a852f10e0b39f3b" title="This function calculates oPad &amp; iPad for HMAC.">Crypto_hmacSha()</a> : This function updates oPad &amp; iPad for HMAC calculation.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a> : Function to configure secure context.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> : Function to transfer and receive data buffer.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a> : Function to free secure context configuration.</li>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a> : De-initialize the SA2UL instance, disable Sa2ul hw engines and de-initialize dma and clears context.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2253"></a>
API Sequence for AES-CMAC Algorithms</h2>
<p>This sequence performs AES CMAC-128 and CMAC-256.</p>
<ul>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> : Initializes a Crypto context and Open an instance of the SA2UL module, enable Sa2ul hw engines and initialize dma.</li>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#gad77fd1f38c3801e9b7e69953cb8e97ff" title="This function Generate Sub keys for CMAC calculation.">Crypto_cmacGenSubKeys()</a> : This function Generate Sub keys for CMAC calculation.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a> : Function to configure secure context.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> : Function to transfer and receive data buffer.</li>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a> : Function to free secure context configuration.</li>
<li><a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a> : De-initialize the SA2UL instance, disable Sa2ul hw engines and de-initialize dma and clears context.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2254"></a>
Opening the SA2UL Driver</h2>
<ul>
<li>The application can open a SA2UL instance by calling <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a>. Please note that opening SA2UL driver is taken care by the SysConfig generated code. This function takes an index into the gSa2ulConfig[] array, and the SA2UL parameters data structure. The SA2UL instance is specified by the index of the SA2UL in gSa2ulConfig[]. Calling <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> second time with the same index previously passed to <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> will result in an error. Re-use the index if the instance is closed via <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2255"></a>
Ultra lite Security Accelerator</h2>
<ul>
<li>Set the ctx parameters using <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> structure, all necessary parameters set to <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> variables and allocate sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a>, to get expected result by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> with input buffer and output buffer as parameters, final output will stored in output buffer. Close sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2256"></a>
AES (Advanced Encryption Standard)</h2>
<ul>
<li>For enabling Sa2ul Aes engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> and it also do initialize Crypto context, set the ctx parameters using <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> structure, all necessary parameters set to <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> variables and allocate sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a>, to get expected result by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> with input buffer and output buffer as parameters, final output will stored in output buffer. Close sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a>. For closing sa2ul Aes engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2257"></a>
SHA (Secure Hash Algorithm)</h2>
<ul>
<li>For enabling Sa2ul Sha engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> and it also do initialize Crypto context, set the ctx parameters using <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> structure, all necessary parameters set to <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> variables and allocate sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a>, to get expected result by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> with input buffer and output buffer as parameters, final output will stored in gSa2ulCtxObj(computedHash) buffer. Close sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a>. For closing sa2ul Sha engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2258"></a>
HMAC-SHA (Keyed-Hash Message Authentication Code Secure Hash Algorithm)</h2>
<ul>
<li>For enabling Sa2ul Sha engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> and it also do initialize Crypto context, set the ctx parameters using <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> structure, all necessary parameters set to <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> variables and allocate sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a>, for ipad and opad call <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#gad224127ab228a0206a852f10e0b39f3b" title="This function calculates oPad &amp; iPad for HMAC.">Crypto_hmacSha()</a>, to get expected result by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> with input buffer and output buffer as parameters, final output will stored in computedHash buffer (present in Sa2ul Ctx Obj). Close sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a>. For closing sa2ul Sha engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2259"></a>
AES-CMAC (Cipher-based Message Authentication Code)</h2>
<ul>
<li>For enabling Sa2ul Aes engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d" title="This function opens a Crypto module.">Crypto_open()</a> and it also do initialize Crypto context, set the ctx parameters using <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> structure, all necessary parameters set to <a class="el" href="structSA2UL__ContextParams.html" title="Parameters passed to SA2UL_contextAlloc()">SA2UL_ContextParams</a> variables and allocate sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7" title="Function to configure secure context.">SA2UL_contextAlloc()</a>, for key1 and key2 call <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#gad77fd1f38c3801e9b7e69953cb8e97ff" title="This function Generate Sub keys for CMAC calculation.">Crypto_cmacGenSubKeys()</a>, to get expected result by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89" title="Function to transfer and recieve data buffer.">SA2UL_contextProcess()</a> with input buffer and output buffer as parameters, final output will stored in output buffer. Close sa2ul context by calling <a class="el" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a" title="Function to free secure context configuration.">SA2UL_contextFree()</a>. For closing sa2ul Sha engine use <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2260"></a>
Closing the SA2UL Driver</h2>
<ul>
<li>The application can Close a SA2UL instance by calling <a class="el" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0" title="Function to close a Crypto module.">Crypto_close()</a>, it close the sa2ul instance passed by the user.</li>
</ul>
<h1><a class="anchor" id="Example_usage"></a>
Example Usage</h1>
<p>Include the below file to access the SA2UL SHA APIs </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include&lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="crypto_8h.html">security/security_common/drivers/crypto/crypto.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sa2ul_8h.html">security/security_common/drivers/crypto/sa2ul/sa2ul.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="structCrypto__Context.html">Crypto_Context</a> gCryptoSha512Context;</div>
<div class="line"><span class="keyword">static</span> uint8_t gCryptoSha512TestBuf[9] = {<span class="stringliteral">&quot;abcdefpra&quot;</span>};</div>
<div class="line"><a class="code" href="structSA2UL__ContextObject.html">SA2UL_ContextObject</a>  gCtxObj;</div>
</div><!-- fragment --><p> sa2ul_sha Example </p><div class="fragment"><div class="line"> </div>
<div class="line">    int32_t             status;</div>
<div class="line">    uint8_t             sha512sum[64];</div>
<div class="line">    <a class="code" href="group__SECURITY__CRYPTO__MODULE.html#ga995b821fa2f903c8914a21b1f8d943a6">Crypto_Handle</a>       shaHandle;</div>
<div class="line">    <a class="code" href="structSA2UL__ContextParams.html">SA2UL_ContextParams</a> ctxParams;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Init SA */</span></div>
<div class="line">    <a class="code" href="group__SECURITY__SA2UL__MODULE.html#gae15d14375610b71e0e4f23fe8e4aae4c">SA2UL_init</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Open SHA instance */</span></div>
<div class="line">    shaHandle = <a class="code" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d">Crypto_open</a>(&amp;gCryptoSha512Context);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Configure secure context */</span></div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a3b3b740e4bee0f5178e65c38240566c4">opType</a>    = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#gae5f81e8495b77fd998c00dfea1caa0dc">SA2UL_OP_AUTH</a>;</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a7df8277515140c40fca189e8b1d92781">hashAlg</a>   = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#gaf81ec518df57c45b3c20f956d2952701">SA2UL_HASH_ALG_SHA2_512</a>;</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a59f009984f5685c47a2717e215921a64">inputLen</a>  = <span class="keyword">sizeof</span>(gCryptoSha512TestBuf);</div>
<div class="line">    gCtxObj.<a class="code" href="structSA2UL__ContextObject.html#abf761b0a15fe6bd932f3f43687f86c4a">totalLengthInBytes</a> = <span class="keyword">sizeof</span>(gCryptoSha512TestBuf);</div>
<div class="line">    status = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7">SA2UL_contextAlloc</a>(gCryptoSha512Context.<a class="code" href="structCrypto__Context.html#a8996d7662490154e1e11156d866058c3">drvHandle</a>,&amp;gCtxObj,&amp;ctxParams);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Perform SHA operation */</span></div>
<div class="line">    status = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89">SA2UL_contextProcess</a>(&amp;gCtxObj,&amp;gCryptoSha512TestBuf[0], <span class="keyword">sizeof</span>(gCryptoSha512TestBuf), sha512sum);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Free the secure context configuration */</span></div>
<div class="line">    <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a">SA2UL_contextFree</a>(&amp;gCtxObj);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close SHA instance */</span></div>
<div class="line">    status = <a class="code" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0">Crypto_close</a>(shaHandle);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*deinit SA */</span></div>
<div class="line">    <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga1e872dce5d605ff48ba08df7c4428a4a">SA2UL_deinit</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Kill warning of variable set but not used */</span></div>
<div class="line">    (void) status;</div>
<div class="line"> </div>
</div><!-- fragment --><p> Include the below file to access the SA2UL AES CBC APIs </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include&lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="crypto_8h.html">security/security_common/drivers/crypto/crypto.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sa2ul_8h.html">security/security_common/drivers//crypto/sa2ul/sa2ul.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* input or output length*/</span></div>
<div class="line"><span class="preprocessor">#define APP_CRYPTO_AES_CBC_256_INOUT_LENGTH           (16U)</span></div>
<div class="line"><span class="comment">/* Aes max key length*/</span></div>
<div class="line"><span class="preprocessor">#define APP_CRYPTO_AES_CBC_256_MAX_KEY_LENGTH         (32U)</span></div>
<div class="line"><span class="comment">/* Aes max IV length*/</span></div>
<div class="line"><span class="preprocessor">#define APP_CRYPTO_AES_CBC_256_MAX_IV_LENGTH          (16U)</span></div>
<div class="line"><span class="comment">/* Aes key length in bites*/</span></div>
<div class="line"><span class="preprocessor">#define APP_CRYPTO_AES_CBC_256_KEY_LENGTH_IN_BITS     (256U)</span></div>
<div class="line"><span class="comment">/* Alignment */</span></div>
<div class="line"><span class="preprocessor">#define APP_CRYPTO_AES_CBC_ALIGNMENT                  (128U)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* input buffer for encryption or decryption */</span></div>
<div class="line"><span class="keyword">static</span> uint8_t gCryptoAesCbc256InputBuf[APP_CRYPTO_AES_CBC_256_INOUT_LENGTH] =</div>
<div class="line">{</div>
<div class="line">    0x81, 0xEA, 0x5B, 0xA4, 0x69, 0x45, 0xC1, 0x70,</div>
<div class="line">    0x5F, 0x6F, 0x89, 0x77, 0x88, 0x68, 0xCC, 0x67</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* The AES encryption algorithm encrypts and decrypts data in blocks of 128 bits. It can do this using 128-bit, 192-bit, or 256-bit keys */</span></div>
<div class="line"><span class="keyword">static</span> uint8_t gCryptoAesCbc256Key[APP_CRYPTO_AES_CBC_256_MAX_KEY_LENGTH] =</div>
<div class="line">{</div>
<div class="line">    0x33, 0xA3, 0x66, 0x46, 0xFE, 0x56, 0xF7, 0x0D,</div>
<div class="line">    0xC0, 0xC5, 0x1A, 0x31, 0x17, 0xE6, 0x39, 0xF1,</div>
<div class="line">    0x82, 0xDE, 0xF8, 0xCA, 0xB5, 0xC0, 0x66, 0x71,</div>
<div class="line">    0xEE, 0xA0, 0x40, 0x7C, 0x48, 0xA9, 0xC7, 0x57</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* initialization vector (IV) is an arbitrary number that can be used along with a secret key for data encryption/decryption. */</span></div>
<div class="line"><span class="keyword">static</span> uint8_t gCryptoAesCbc256Iv[APP_CRYPTO_AES_CBC_256_MAX_IV_LENGTH] =</div>
<div class="line">{</div>
<div class="line">    0x7C, 0xE2, 0xAB, 0xAF, 0x8B, 0xEF, 0x23, 0xC4,</div>
<div class="line">    0x81, 0x6D, 0xC8, 0xCE, 0x84, 0x20, 0x48, 0xA7</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Encryption output buf */</span></div>
<div class="line">uint8_t     gCryptoAesCbc256EncResultBuf[APP_CRYPTO_AES_CBC_256_INOUT_LENGTH] <a class="code" href="group__tisci__boardcfg.html#ga57138dae4c1d6449a21591300705a7a0">__attribute__</a> ((aligned (APP_CRYPTO_AES_CBC_ALIGNMENT)));</div>
<div class="line"><span class="comment">/* Decryption output buf */</span></div>
<div class="line">uint8_t     gCryptoAesCbc256DecResultBuf[APP_CRYPTO_AES_CBC_256_INOUT_LENGTH] <a class="code" href="group__tisci__boardcfg.html#ga57138dae4c1d6449a21591300705a7a0">__attribute__</a> ((aligned (APP_CRYPTO_AES_CBC_ALIGNMENT)));</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Context memory */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="structCrypto__Context.html">Crypto_Context</a> gCryptoAesCbcContext <a class="code" href="group__tisci__boardcfg.html#ga57138dae4c1d6449a21591300705a7a0">__attribute__</a> ((aligned (<a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga6013b53f67e682e0730c7a45869dd415">SA2UL_CACHELINE_ALIGNMENT</a>)));</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Context Object */</span></div>
<div class="line"><a class="code" href="structSA2UL__ContextObject.html">SA2UL_ContextObject</a>  gSa2ulCtxObj <a class="code" href="group__tisci__boardcfg.html#ga57138dae4c1d6449a21591300705a7a0">__attribute__</a> ((aligned (<a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga6013b53f67e682e0730c7a45869dd415">SA2UL_CACHELINE_ALIGNMENT</a>)));</div>
<div class="line"> </div>
</div><!-- fragment --><p> sa2ul_aes_cbc Example </p><div class="fragment"><div class="line">    int32_t             status;</div>
<div class="line">    <a class="code" href="group__SECURITY__CRYPTO__MODULE.html#ga995b821fa2f903c8914a21b1f8d943a6">Crypto_Handle</a>       aesHandle;</div>
<div class="line">    <a class="code" href="structSA2UL__ContextParams.html">SA2UL_ContextParams</a> ctxParams;</div>
<div class="line"> </div>
<div class="line">    aesHandle = <a class="code" href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d">Crypto_open</a>(&amp;gCryptoAesCbcContext);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Configure secure context */</span></div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a3b3b740e4bee0f5178e65c38240566c4">opType</a>       = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga6b291b064dac331b313ba2cf8546dc4d">SA2UL_OP_ENC</a>;</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a3b46984efd8ae771d9f0695204aba1b0">encAlg</a>       = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga0a36e69ab6ba78eef65ba24ab2937516">SA2UL_ENC_ALG_AES</a>;</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#ae1192c6c98c24b95d127d7509383c3f8">encMode</a>      = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#gaa78dfccb7a01d9532790b36282431272">SA2UL_ENC_MODE_CBC</a>;</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a0f7ad9d505a987ad9e417a9334ce3837">encKeySize</a>   = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga9956d05af5ceb5904a6349d0127da419">SA2UL_ENC_KEYSIZE_256</a>;</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#adf46e5a0235e6f0f9885f05fbc87331c">encDirection</a> = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga5bea5eb0d77573fee53f158b6e0add74">SA2UL_ENC_DIR_ENCRYPT</a>;</div>
<div class="line">    memcpy( &amp;ctxParams.<a class="code" href="structSA2UL__ContextParams.html#aabe58456c15180bc558416808153f005">key</a>[0], &amp;gCryptoAesCbc256Key[0], <a class="code" href="group__SECURITY__SA2UL__MODULE.html#gadc87572c677b13071c5f5074881667d7">SA2UL_MAX_KEY_SIZE_BYTES</a>);</div>
<div class="line">    memcpy( &amp;ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a49dd0b37992b6b40450be7061c1533a7">iv</a>[0], &amp;gCryptoAesCbc256Iv[0], <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga2741e73041501af743e14b70d92db6a8">SA2UL_MAX_IV_SIZE_BYTES</a>);</div>
<div class="line">    ctxParams.<a class="code" href="structSA2UL__ContextParams.html#a59f009984f5685c47a2717e215921a64">inputLen</a> = <span class="keyword">sizeof</span>(gCryptoAesCbc256InputBuf);</div>
<div class="line">    gSa2ulCtxObj.totalLengthInBytes = <span class="keyword">sizeof</span>(gCryptoAesCbc256InputBuf);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Function to configure secure context */</span></div>
<div class="line">    status = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7">SA2UL_contextAlloc</a>(gCryptoAesCbcContext.drvHandle, &amp;gSa2ulCtxObj, &amp;ctxParams);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Encryption */</span></div>
<div class="line">    <span class="comment">/* Function to transfer and receive data buffer */</span></div>
<div class="line">    status = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89">SA2UL_contextProcess</a>(&amp;gSa2ulCtxObj,&amp;gCryptoAesCbc256InputBuf[0], <span class="keyword">sizeof</span>(gCryptoAesCbc256InputBuf), gCryptoAesCbc256EncResultBuf);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Function to free secure context configuration*/</span></div>
<div class="line">    status = <a class="code" href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a">SA2UL_contextFree</a>(&amp;gSa2ulCtxObj);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close AES instance */</span></div>
<div class="line">    status = <a class="code" href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0">Crypto_close</a>(aesHandle);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Kill warning of variable set but not used */</span></div>
<div class="line">    (void) status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md2261"></a>
Directory Structure</h1>
<p>Given below is a overview of the directory structure to help you navigate the Crypto structure. </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Folder/Files  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">source/security/crypto  </td><td class="markdownTableBodyNone">Contains Crypto driver files   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">source/security/crypto/sa2ul  </td><td class="markdownTableBodyNone">Contains Sa2ul driver files   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">source/security/crypto/pka  </td><td class="markdownTableBodyNone">Contains Pka driver files   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">examples/security  </td><td class="markdownTableBodyNone">Contains all Security examples   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2262"></a>
API</h1>
<ul>
<li><a class="el" href="group__SECURITY__SA2UL__MODULE.html">APIs for SA2UL</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="astructCrypto__Context_html"><div class="ttname"><a href="structCrypto__Context.html">Crypto_Context</a></div><div class="ttdoc">CRYPTO driver context.</div><div class="ttdef"><b>Definition:</b> crypto.h:92</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga6013b53f67e682e0730c7a45869dd415"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga6013b53f67e682e0730c7a45869dd415">SA2UL_CACHELINE_ALIGNMENT</a></div><div class="ttdeci">#define SA2UL_CACHELINE_ALIGNMENT</div><div class="ttdoc">Cache line size for alignment of descriptor and buffers.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:81</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_a7df8277515140c40fca189e8b1d92781"><div class="ttname"><a href="structSA2UL__ContextParams.html#a7df8277515140c40fca189e8b1d92781">SA2UL_ContextParams::hashAlg</a></div><div class="ttdeci">uint8_t hashAlg</div><div class="ttdef"><b>Definition:</b> sa2ul.h:213</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_gaa78dfccb7a01d9532790b36282431272"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#gaa78dfccb7a01d9532790b36282431272">SA2UL_ENC_MODE_CBC</a></div><div class="ttdeci">#define SA2UL_ENC_MODE_CBC</div><div class="ttdoc">CBC mode.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:177</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html"><div class="ttname"><a href="structSA2UL__ContextParams.html">SA2UL_ContextParams</a></div><div class="ttdoc">Parameters passed to SA2UL_contextAlloc()</div><div class="ttdef"><b>Definition:</b> sa2ul.h:210</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga9956d05af5ceb5904a6349d0127da419"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga9956d05af5ceb5904a6349d0127da419">SA2UL_ENC_KEYSIZE_256</a></div><div class="ttdeci">#define SA2UL_ENC_KEYSIZE_256</div><div class="ttdoc">Encryption 256 bit key size.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:192</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_ae1192c6c98c24b95d127d7509383c3f8"><div class="ttname"><a href="structSA2UL__ContextParams.html#ae1192c6c98c24b95d127d7509383c3f8">SA2UL_ContextParams::encMode</a></div><div class="ttdeci">uint8_t encMode</div><div class="ttdef"><b>Definition:</b> sa2ul.h:219</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_a0f7ad9d505a987ad9e417a9334ce3837"><div class="ttname"><a href="structSA2UL__ContextParams.html#a0f7ad9d505a987ad9e417a9334ce3837">SA2UL_ContextParams::encKeySize</a></div><div class="ttdeci">uint8_t encKeySize</div><div class="ttdef"><b>Definition:</b> sa2ul.h:223</div></div>
<div class="ttc" id="astructSA2UL__ContextObject_html"><div class="ttname"><a href="structSA2UL__ContextObject.html">SA2UL_ContextObject</a></div><div class="ttdoc">SA2UL context object structure.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:442</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_a3b3b740e4bee0f5178e65c38240566c4"><div class="ttname"><a href="structSA2UL__ContextParams.html#a3b3b740e4bee0f5178e65c38240566c4">SA2UL_ContextParams::opType</a></div><div class="ttdeci">uint8_t opType</div><div class="ttdef"><b>Definition:</b> sa2ul.h:211</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga30ed3b63c0f9269b24fc6e3ed785448a"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga30ed3b63c0f9269b24fc6e3ed785448a">SA2UL_contextFree</a></div><div class="ttdeci">int32_t SA2UL_contextFree(SA2UL_ContextObject *pCtxObj)</div><div class="ttdoc">Function to free secure context configuration.</div></div>
<div class="ttc" id="astructSA2UL__ContextObject_html_abf761b0a15fe6bd932f3f43687f86c4a"><div class="ttname"><a href="structSA2UL__ContextObject.html#abf761b0a15fe6bd932f3f43687f86c4a">SA2UL_ContextObject::totalLengthInBytes</a></div><div class="ttdeci">uint32_t totalLengthInBytes</div><div class="ttdef"><b>Definition:</b> sa2ul.h:449</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga729624305afca681e8471f73b98d21c7"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga729624305afca681e8471f73b98d21c7">SA2UL_contextAlloc</a></div><div class="ttdeci">int32_t SA2UL_contextAlloc(SA2UL_Handle handle, SA2UL_ContextObject *ctxObj, const SA2UL_ContextParams *ctxPrms)</div><div class="ttdoc">Function to configure secure context.</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_aabe58456c15180bc558416808153f005"><div class="ttname"><a href="structSA2UL__ContextParams.html#aabe58456c15180bc558416808153f005">SA2UL_ContextParams::key</a></div><div class="ttdeci">uint8_t key[SA2UL_MAX_KEY_SIZE_BYTES]</div><div class="ttdef"><b>Definition:</b> sa2ul.h:221</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga2741e73041501af743e14b70d92db6a8"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga2741e73041501af743e14b70d92db6a8">SA2UL_MAX_IV_SIZE_BYTES</a></div><div class="ttdeci">#define SA2UL_MAX_IV_SIZE_BYTES</div><div class="ttdoc">Max Initialization vector (IV) size in bytes.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:77</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_a49dd0b37992b6b40450be7061c1533a7"><div class="ttname"><a href="structSA2UL__ContextParams.html#a49dd0b37992b6b40450be7061c1533a7">SA2UL_ContextParams::iv</a></div><div class="ttdeci">uint8_t iv[SA2UL_MAX_IV_SIZE_BYTES]</div><div class="ttdef"><b>Definition:</b> sa2ul.h:227</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga3ac69e2913b96fda424018136a5b8f89"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga3ac69e2913b96fda424018136a5b8f89">SA2UL_contextProcess</a></div><div class="ttdeci">int32_t SA2UL_contextProcess(SA2UL_ContextObject *ctxObj, const uint8_t *input, uint32_t ilen, uint8_t *output)</div><div class="ttdoc">Function to transfer and recieve data buffer.</div></div>
<div class="ttc" id="agroup__SECURITY__CRYPTO__MODULE_html_ga7f8ef72370ba6a238931006d2669b64d"><div class="ttname"><a href="group__SECURITY__CRYPTO__MODULE.html#ga7f8ef72370ba6a238931006d2669b64d">Crypto_open</a></div><div class="ttdeci">Crypto_Handle Crypto_open(Crypto_Context *ctx)</div><div class="ttdoc">This function opens a Crypto module.</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_gae15d14375610b71e0e4f23fe8e4aae4c"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#gae15d14375610b71e0e4f23fe8e4aae4c">SA2UL_init</a></div><div class="ttdeci">void SA2UL_init(void)</div><div class="ttdoc">This function initializes the SA2UL module.</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_a3b46984efd8ae771d9f0695204aba1b0"><div class="ttname"><a href="structSA2UL__ContextParams.html#a3b46984efd8ae771d9f0695204aba1b0">SA2UL_ContextParams::encAlg</a></div><div class="ttdeci">uint8_t encAlg</div><div class="ttdef"><b>Definition:</b> sa2ul.h:215</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga6b291b064dac331b313ba2cf8546dc4d"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga6b291b064dac331b313ba2cf8546dc4d">SA2UL_OP_ENC</a></div><div class="ttdeci">#define SA2UL_OP_ENC</div><div class="ttdoc">SA2UL operations encryption.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:117</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_gae5f81e8495b77fd998c00dfea1caa0dc"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#gae5f81e8495b77fd998c00dfea1caa0dc">SA2UL_OP_AUTH</a></div><div class="ttdeci">#define SA2UL_OP_AUTH</div><div class="ttdoc">SA2UL operations authentication.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:119</div></div>
<div class="ttc" id="acrypto_8h_html"><div class="ttname"><a href="crypto_8h.html">crypto.h</a></div><div class="ttdoc">This file contains the prototype of crypto driver APIs.</div></div>
<div class="ttc" id="agroup__tisci__boardcfg_html_ga57138dae4c1d6449a21591300705a7a0"><div class="ttname"><a href="group__tisci__boardcfg.html#ga57138dae4c1d6449a21591300705a7a0">__attribute__</a></div><div class="ttdeci">struct tisci_boardcfg_sa2ul_cfg __attribute__</div><div class="ttdoc">UInteger224 (802.1AS, 10.3.4 time-synchronization spanning tree priority vectors )</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_gadc87572c677b13071c5f5074881667d7"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#gadc87572c677b13071c5f5074881667d7">SA2UL_MAX_KEY_SIZE_BYTES</a></div><div class="ttdeci">#define SA2UL_MAX_KEY_SIZE_BYTES</div><div class="ttdoc">Max key size in bytes.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:75</div></div>
<div class="ttc" id="asa2ul_8h_html"><div class="ttname"><a href="sa2ul_8h.html">sa2ul.h</a></div><div class="ttdoc">This file contains the prototype of SA2UL driver APIs.</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_a59f009984f5685c47a2717e215921a64"><div class="ttname"><a href="structSA2UL__ContextParams.html#a59f009984f5685c47a2717e215921a64">SA2UL_ContextParams::inputLen</a></div><div class="ttdeci">uint32_t inputLen</div><div class="ttdef"><b>Definition:</b> sa2ul.h:225</div></div>
<div class="ttc" id="agroup__SECURITY__CRYPTO__MODULE_html_ga7bf778bf0057cdd8cdea70b55ba77eb0"><div class="ttname"><a href="group__SECURITY__CRYPTO__MODULE.html#ga7bf778bf0057cdd8cdea70b55ba77eb0">Crypto_close</a></div><div class="ttdeci">int32_t Crypto_close(Crypto_Handle handle)</div><div class="ttdoc">Function to close a Crypto module.</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_gaf81ec518df57c45b3c20f956d2952701"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#gaf81ec518df57c45b3c20f956d2952701">SA2UL_HASH_ALG_SHA2_512</a></div><div class="ttdeci">#define SA2UL_HASH_ALG_SHA2_512</div><div class="ttdoc">Hash Algo SHA-512.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:108</div></div>
<div class="ttc" id="astructSA2UL__ContextParams_html_adf46e5a0235e6f0f9885f05fbc87331c"><div class="ttname"><a href="structSA2UL__ContextParams.html#adf46e5a0235e6f0f9885f05fbc87331c">SA2UL_ContextParams::encDirection</a></div><div class="ttdeci">uint8_t encDirection</div><div class="ttdef"><b>Definition:</b> sa2ul.h:217</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga0a36e69ab6ba78eef65ba24ab2937516"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga0a36e69ab6ba78eef65ba24ab2937516">SA2UL_ENC_ALG_AES</a></div><div class="ttdeci">#define SA2UL_ENC_ALG_AES</div><div class="ttdoc">SA2UL AES Encryption Algorithm.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:151</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga5bea5eb0d77573fee53f158b6e0add74"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga5bea5eb0d77573fee53f158b6e0add74">SA2UL_ENC_DIR_ENCRYPT</a></div><div class="ttdeci">#define SA2UL_ENC_DIR_ENCRYPT</div><div class="ttdoc">Encryption direction.</div><div class="ttdef"><b>Definition:</b> sa2ul.h:164</div></div>
<div class="ttc" id="astructCrypto__Context_html_a8996d7662490154e1e11156d866058c3"><div class="ttname"><a href="structCrypto__Context.html#a8996d7662490154e1e11156d866058c3">Crypto_Context::drvHandle</a></div><div class="ttdeci">void * drvHandle</div><div class="ttdef"><b>Definition:</b> crypto.h:93</div></div>
<div class="ttc" id="agroup__SECURITY__SA2UL__MODULE_html_ga1e872dce5d605ff48ba08df7c4428a4a"><div class="ttname"><a href="group__SECURITY__SA2UL__MODULE.html#ga1e872dce5d605ff48ba08df7c4428a4a">SA2UL_deinit</a></div><div class="ttdeci">void SA2UL_deinit(void)</div><div class="ttdoc">This function de-initializes the SA2UL module.</div></div>
<div class="ttc" id="agroup__SECURITY__CRYPTO__MODULE_html_ga995b821fa2f903c8914a21b1f8d943a6"><div class="ttname"><a href="group__SECURITY__CRYPTO__MODULE.html#ga995b821fa2f903c8914a21b1f8d943a6">Crypto_Handle</a></div><div class="ttdeci">void * Crypto_Handle</div><div class="ttdoc">Handle to the Crypto driver returned by Crypto_open()</div><div class="ttdef"><b>Definition:</b> crypto.h:84</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
