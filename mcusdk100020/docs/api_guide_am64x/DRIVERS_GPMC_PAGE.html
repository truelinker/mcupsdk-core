<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: GPMC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DRIVERS_GPMC_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GPMC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1964">Features Supported</a></li>
<li class="level1"><a href="#autotoc_md1965">SysConfig Features</a></li>
<li class="level1"><a href="#autotoc_md1966">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md1967">GPMC Overview</a></li>
<li class="level1"><a href="#autotoc_md1968">ECC Calculator</a></li>
<li class="level1"><a href="#autotoc_md1969">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md1970">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_drivers_gpmc"></a></p>
<p>The General-Purpose Memory Controller (GPMC) is an unified memory controller dedicated to interfacing external memory devices like</p><ul>
<li>Asynchronous SRAM like memories and application specific integrated circuit devices</li>
<li>Asynchronous, synchronous, and page mode burst NOR flash devices</li>
<li>NAND flash</li>
<li>Pseudo-SRAM devices</li>
</ul>
<p>The Error Location Module (ELM) module works in conjunction with the GPMC and has the following main features: ECC calculations (up to 16-bit) for NAND support and ability to work in both page-based and continuous modes</p><ul>
<li>4, 8, and 16 bits per 512-byte block error-location, based on BCH algorithms</li>
<li>Eight simultaneous processing contexts</li>
<li>Page-based and continuous modes</li>
<li>Interrupt generation on error-location process completion</li>
</ul>
<h1><a class="anchor" id="autotoc_md1964"></a>
Features Supported</h1>
<ul>
<li>8-bit wide data path to external memory device</li>
<li>Supports up to 4 chip select regions of programmable size and programmable base addresses in a total address space of 1GB</li>
<li>Supports on-the-fly error code detection using the Bose-Chaudhuri-Hocquenghem (BCH) 8-bit.</li>
<li>Fully pipelined operation for optimal memory bandwidth usage</li>
<li>The clock to the external memory is provided from GPMC_FCLK divided by 1, 2, 3, or 4</li>
<li>Supports programmable autoclock gating when no access is detected</li>
<li>Independent and programmable control signal timing parameters for setup and hold time on a per-chip basis. Parameters are set according to the memory device timing parameters with a timing granularity of one GPMC_FCLK clock cycle.</li>
<li>Flexible internal access time control (wait state) and flexible handshake mode using external WAIT pin monitoring</li>
<li>Support bus keeping</li>
<li>Support bus turnaround</li>
<li>Prefetch and write-posting engine associated with DMA controller at system level to achieve full performance from the NAND device with minimum effect on NOR/SRAM concurrent access</li>
<li>32-bit interconnect target interface which supports non-wrapping and wrapping burst of up to 16x32 bits</li>
<li>Flexible synchrnonisation of NAND R/B signal with WAIT PINs.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1965"></a>
SysConfig Features</h1>
<dl class="section note"><dt>Note</dt><dd>It is strongly recommend to use SysConfig where it is available instead of using direct SW API calls. This will help simplify the SW application and also catch common mistakes early in the development cycle.</dd></dl>
<ul>
<li>Set input clock frequency and clock divider</li>
<li>Set interrupt trigger type</li>
<li>Configuring pinmux based on selected pin</li>
<li>Enable or disable DMA (By default DMA is enabled)</li>
</ul>
<h1><a class="anchor" id="autotoc_md1966"></a>
Features NOT Supported</h1>
<ul>
<li>Multiple write access in asynchronous mode is not supported</li>
<li>Multiple read access in asynchronous mode is not supported in address/data-multiplexed and AAD- multiplexed modes</li>
<li>Interupt mode is not supported.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1967"></a>
GPMC Overview</h1>
<p>The GPMC basic programming model offers maximum flexibility to support various access protocols for each of the four configurable chip-selects. Use optimal chip-select settings, based on the characteristics of the external device:</p><ul>
<li>Different protocols can be selected to support generic asynchronous or synchronous random-access devices (NOR flash, SRAM) or to support specific NAND devices.</li>
<li>The address and data bus can be multiplexed on the same external bus.</li>
<li>Read and write access can be independently defined as asynchronous or synchronous.</li>
<li>System requests (byte, 16-bit word, burst) are performed through single or multiple accesses. External access profiles (single, multiple with optimized burst length, native- or emulated-wrap) are based on external device characteristics (supported protocol, bus width, data buffer size, native-wrap support).</li>
<li>System burst read or write requests are synchronous-burst (multiple-read or multiple-write). When neither burst nor page mode is supported by external memory or ASIC devices, system burst read or write requests are translated to successive single synchronous or asynchronous accesses (single reads or single writes). 8-bit wide devices are supported only in single synchronous or single asynchronous read or write mode.</li>
<li>To simulate a programmable internal-wait-state, an external WAIT pin can be monitored to dynamically control external access at the beginning (initial access time) of and during a burst access. Each control signal is controlled independently for each chip-select. The internal functional clock of the GPMC (GPMC_FCLK) is used as a time reference to specify the following:<ol type="1">
<li>Read- and write-access duration</li>
<li>Most GPMC external interface control-signal assertion and deassertion times</li>
<li>Data-capture time during read access</li>
<li>External wait-pin monitoring time</li>
<li>Duration of idle time between accesses, when required</li>
</ol>
</li>
</ul>
<p>Below figure shows the GPMC functional block diagram. The GPMC consists of six blocks:</p><ul>
<li>Interconnect port interface</li>
<li>Address decoder, GPMC configuration, and chip-select configuration register file</li>
<li>Access engine</li>
<li>Prefetch and write-posting engine</li>
<li>Error correction code engine (ECC)</li>
<li>External device/memory port interface  <style>div.image img[src="gpmc_block_diagram.png"]{width:2%"}</style> <div class="image">
<img src="gpmc_block_diagram.png" alt=""/>
<div class="caption">
GPMC FUNCTIONAL BLOCK DIAGRAM</div></div>
</li>
</ul>
<p>The GPMC can access various external devices. The flexible programming model allows a wide range of attached device types and access schemes. Based on the programmed configuration bit fields stored in the GPMC registers, the GPMC can generate the timing of all control signals depending on the attached device and access type. Given the chip-select decoding and its associated configuration registers, the GPMC selects the appropriate control signal timing for the device type</p>
<h1><a class="anchor" id="autotoc_md1968"></a>
ECC Calculator</h1>
<ul>
<li>The GPMC includes an error code correction (ECC) calculator circuitry that enables ECC calculation on the fly during data read or data program (that is, write) operations. The page size supported by the ECC calculator in one calculation/context is 512 bytes.</li>
<li>The user can choose from two different algorithms with different error correction capabilities through the GPMC_ECC_CONFIG[16] ECCALGORITHM bit:<ol type="1">
<li>Hamming code for 1-bit error code correction on 8- or 16-bit NAND flash organized with page size greater than 512 bytes</li>
<li>Bose-Chaudhurl-Hocquenghem (BCH) code for 4- to 16-bit error correction The GPMC does not handle the error code correction directly. During writes, the GPMC computes parity bits. During reads, the GPMC provides enough information for the processor to correct errors without reading the data buffer all over again.</li>
</ol>
</li>
<li>The Hamming code ECC is based on a 2-dimensional (2D) (row and column) bit parity accumulation. This parity accumulation is accomplished on the programmed number of bytes or 16-bit words read from the memory device, or is written to the memory device in stream mode.</li>
<li>Because the ECC engine includes only one accumulation context, it can be allocated to only one chip-select at a time through the GPMC_ECC_CONFIG[3-1] ECCCS bit field. Even if two chip-selects use different ECC algorithms, one the Hamming code and the other a BCH code, they must define separate ECC contexts because some of the ECC registers are common to all types of algorithms.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1969"></a>
Example Usage</h1>
<p>Include the below file to access the APIs </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;drivers/gpmc.h&gt;</span></div>
</div><!-- fragment --><p> GPMC Instance Open </p><div class="fragment"><div class="line">    <a class="code" href="structGPMC__Params.html">GPMC_Params</a> gpmcParams;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__DRV__GPMC__MODULE.html#ga2d732506dd789aa685f70da2d7c01bab">GPMC_Params_init</a>(&amp;gpmcParams);</div>
<div class="line">    gGpmcHandle = <a class="code" href="group__DRV__GPMC__MODULE.html#gae3bcb5e923271322de00c6e0da81a9e4">GPMC_open</a>(0, &amp;gpmcParams);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(gGpmcHandle != NULL);</div>
</div><!-- fragment --><p> GPMC Instance Close </p><div class="fragment"><div class="line">    <a class="code" href="group__DRV__GPMC__MODULE.html#ga7ea9dfb52286461c0e982cc67dced01a">GPMC_close</a>(gGpmcHandle);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1970"></a>
API</h1>
<p><a class="el" href="group__DRV__GPMC__MODULE.html">APIs for GPMC</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__DRV__GPMC__MODULE_html_ga2d732506dd789aa685f70da2d7c01bab"><div class="ttname"><a href="group__DRV__GPMC__MODULE.html#ga2d732506dd789aa685f70da2d7c01bab">GPMC_Params_init</a></div><div class="ttdeci">static void GPMC_Params_init(GPMC_Params *params)</div><div class="ttdoc">Function to initialize the GPMC_Params struct to its defaults.</div><div class="ttdef"><b>Definition:</b> gpmc.h:1216</div></div>
<div class="ttc" id="agroup__DRV__GPMC__MODULE_html_ga7ea9dfb52286461c0e982cc67dced01a"><div class="ttname"><a href="group__DRV__GPMC__MODULE.html#ga7ea9dfb52286461c0e982cc67dced01a">GPMC_close</a></div><div class="ttdeci">void GPMC_close(GPMC_Handle handle)</div><div class="ttdoc">Function to close a GPMC peripheral specified by the GPMC handle.</div></div>
<div class="ttc" id="agroup__DRV__GPMC__MODULE_html_gae3bcb5e923271322de00c6e0da81a9e4"><div class="ttname"><a href="group__DRV__GPMC__MODULE.html#gae3bcb5e923271322de00c6e0da81a9e4">GPMC_open</a></div><div class="ttdeci">GPMC_Handle GPMC_open(uint32_t index, const GPMC_Params *prms)</div><div class="ttdoc">This function opens a given GPMC peripheral.</div></div>
<div class="ttc" id="astructGPMC__Params_html"><div class="ttname"><a href="structGPMC__Params.html">GPMC_Params</a></div><div class="ttdoc">GPMC driver instance parameters.</div><div class="ttdef"><b>Definition:</b> gpmc.h:627</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_ga552e9055ca7eab5fe6c224c6cd5a9d4c"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a></div><div class="ttdeci">#define DebugP_assert(expression)</div><div class="ttdoc">Function to call for assert check.</div><div class="ttdef"><b>Definition:</b> DebugP.h:177</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
