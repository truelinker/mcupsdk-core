<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: USB</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('USB_DEVICE_DRIVER.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">USB </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md2180">Introduction</a></li>
<li class="level1"><a href="#autotoc_md2181">Features Supported</a><ul><li class="level2"><a href="#autotoc_md2182">TinyUSB</a></li>
<li class="level2"><a href="#autotoc_md2183">USB Device Driver</a></li>
<li class="level2"><a href="#autotoc_md2184">SoC Porting Layer</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md2185">SysConfig Features</a></li>
<li class="level1"><a href="#autotoc_md2186">Features Not Supported</a></li>
<li class="level1"><a href="#autotoc_md2187">Implementation Note</a></li>
<li class="level1"><a href="#autotoc_md2188">USB Logging</a></li>
<li class="level1"><a href="#autotoc_md2189">Important files and directory structure</a></li>
<li class="level1"><a href="#TINYUSB_ADDITIONAL_REFERENCES">Additional References</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_usb_usb_driver"></a></p>
<h1><a class="anchor" id="autotoc_md2180"></a>
Introduction</h1>
<p>The USB SW stack in MCU+ SDK is shown below.</p>
<p> <style>div.image img[src="usb_cdc_tinyusb_arch.png"]{width:30%}</style> </p><div class="image">
<img src="usb_cdc_tinyusb_arch.png" alt=""/>
<div class="caption">
USB SW Stack Block Diagram</div></div>
<p>There are three layers as listed below,</p><ul>
<li>TinyUSB: This is the USB stack itself and acts as the interface for user application to USB</li>
<li>USB Device Driver: This is the USB HW and SOC specific device drivers</li>
<li>TinyUSB Porting Layer: This is the layer which binds the open source TinyUSB stack to the SOC specific device driver</li>
</ul>
<p>We encourage customers to use USB peripheral from tinyUSB APIs. The <a class="el" href="EXAMPLES_USB_CDC_ECHO.html">USB CDC Echo Example</a> is using the CDC class API from TinyUSB. This way, customers can easily adapt to other TinyUSB examples.</p>
<p>For advanced customers or 3P USB stack vendors, refer to the USB device driver references listed below.</p>
<h1><a class="anchor" id="autotoc_md2181"></a>
Features Supported</h1>
<h2><a class="anchor" id="autotoc_md2182"></a>
TinyUSB</h2>
<p>TinyUSB is an open-source cross-platform USB Host/Device stack for embedded system, designed to be memory-safe with no dynamic allocation and thread-safe with all interrupt events are deferred then handled in the non-ISR task function.</p>
<p>Below features are supported in the SDK</p><ul>
<li>USB device</li>
<li>USB CDC Class</li>
<li>USB DFU Class</li>
<li>USB NCM Class</li>
<li>USB RNDIS Class</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Supported TinyUSB version is <a href="https://github.com/hathach/tinyusb/tree/0.14.0">0.14.0</a></dd></dl>
<h2><a class="anchor" id="autotoc_md2183"></a>
USB Device Driver</h2>
<p>The USB device driver is the USB HW specific software component that provides a programming abstraction to the Cadence USB IP included in the SOC and supports below features,</p>
<ul>
<li>USB device instance creation/deletion</li>
<li>USB device endpoint handling</li>
<li>USB device data transfer</li>
<li>USB device interrupts and DMA</li>
</ul>
<h2><a class="anchor" id="autotoc_md2184"></a>
SoC Porting Layer</h2>
<p>The SoC porting layer for USB device driver is the glue layer between the SoC and the USB device driver and does the below,</p>
<ul>
<li>Pinmux needed for USB device</li>
<li>Clock source selection needed for USB device</li>
<li>Clock settings needed for USB device</li>
<li>Configure the USB HW for USB device mode</li>
</ul>
<h1><a class="anchor" id="autotoc_md2185"></a>
SysConfig Features</h1>
<dl class="section note"><dt>Note</dt><dd>It is strongly recommend to use SysConfig where it is available instead of using direct SW API calls. This will help simplify the SW application and also catch common mistakes early in the development cycle.</dd></dl>
<ul>
<li>Initialize USB device driver including clock setup and pinmux</li>
</ul>
<h1><a class="anchor" id="autotoc_md2186"></a>
Features Not Supported</h1>
<ul>
<li>TinyUSB Class Drivers Other Than CDC,DFU,NCM &amp; RNDIS</li>
<li>TinyUSB Host Core Driver and Class Drivers</li>
<li>USB 3.0</li>
<li>USB 2.0 Host Mode</li>
<li>USB Dual Role Mode</li>
</ul>
<h1><a class="anchor" id="autotoc_md2187"></a>
Implementation Note</h1>
<ul>
<li>USB device class driver should be operating as higher priority task if host driver is implemented as polling for device response with strict timeout.</li>
<li>If Cadence driver is used with TinyUSB, makefiles of both example and driver should define TINYUSB_INTEGRATION (like default cdc_echo example). This macro defined in driver and not in example or vice versa is an invalid combination.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2188"></a>
USB Logging</h1>
<ul>
<li>User needs to define following macros to enable logs.<ol type="1">
<li><b>CFG_TUSB_DEBUG</b> for enabling logs in <b>TinyUSB</b> stack .</li>
<li><b>CFG_CUSB_DEBUG</b> for enabling logs in <b>USB device driver</b>.</li>
</ol>
</li>
<li>By defult logging for both the modules will be enabled in <b>debug</b> profile and disabled in <b>release</b> profile.</li>
<li>There is a provision for enabling and disabling logs for certain modules in USB device driver for better performance. Moreover user can also define required verbosity level.</li>
<li>Approprite verbosity levels<ol type="1">
<li><b>DBG_CRIT</b> - critical <br  />
</li>
<li><b>DBG_WARN</b> - warning</li>
<li><b>DBG_FYI</b> - fyi</li>
<li><b>DBG_HIVERB</b> - highly verbose</li>
</ol>
</li>
<li>refer to <a class="el" href="group__CUSBD__MODULE__IDS.html">cadence USB device driver module Id</a> to check out module Ids.</li>
<li>refer to <a class="el" href="group__USB__MODULE.html">APIs for USB</a> for API definitions.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Due to timings issue UART logs may not give expected performance in debug profile as the code is not optimized If user needs high verbose logs is recomended to use UART logs in <b>release profile or use shared memory logging.</b></li>
<li>refer <a class="el" href="KERNEL_DPL_DEBUG_PAGE.html">Debug</a> for more information on <b>shared memory logging</b> and how to use it.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="autotoc_md2189"></a>
Important files and directory structure</h1>
<table class="doxtable">
<tr>
<th>Folder/Files </th><th>Description  </th></tr>
<tr>
<td colspan="2" bgcolor="#F0F0F0">${SDK_INSTALL_PATH}/source/usb/tinyusb </td></tr>
<tr>
<td>config/ </td><td>TinyUSB Stack configuration  </td></tr>
<tr>
<td>portable/ </td><td>TinyUSB Stack porting  </td></tr>
<tr>
<td>tinyusb-stack/ </td><td>TinyUSB Stack source files  </td></tr>
<tr>
<td colspan="2" bgcolor="#F0F0F0">${SDK_INSTALL_PATH}/source/usb/cdn </td></tr>
<tr>
<td>core_driver/ </td><td>Cadence USB core driver source files  </td></tr>
<tr>
<td>doc/ </td><td>Cadence USB core driver documents  </td></tr>
<tr>
<td>include/ </td><td>Cadence USB core driver Soc porting layer API header files  </td></tr>
<tr>
<td>soc/ </td><td>Cadence USB core driver Soc porting layer source files  </td></tr>
</table>
<h1><a class="anchor" id="TINYUSB_ADDITIONAL_REFERENCES"></a>
Additional References</h1>
<table class="doxtable">
<tr>
<th>References  </th></tr>
<tr>
<td colspan="1" bgcolor="#F0F0F0">SOC Porting Layer  </td></tr>
<tr>
<td><a class="el" href="EXAMPLES_USB_CDC_ECHO.html">USB CDC Echo Example</a>  </td></tr>
<tr>
<td><a class="el" href="EXAMPLES_USB_DFU.html">USB DFU Example</a>  </td></tr>
<tr>
<td><a class="el" href="EXAMPLES_USB_NCM.html">USB NCM Example</a>  </td></tr>
<tr>
<td><a class="el" href="EXAMPLES_USB_RNDIS.html">USB RNDIS Example</a>  </td></tr>
<tr>
<td colspan="1" bgcolor="#F0F0F0">TinyUSB  </td></tr>
<tr>
<td><a href="https://github.com/hathach/tinyusb">TinyUSB Github Project</a>  </td></tr>
<tr>
<td colspan="1" bgcolor="#F0F0F0">USB Device Driver  </td></tr>
<tr>
<td><a href="../../source/usb/cdn/doc/usb_ss_drd_driver_quick_start_guide.pdf">USB Device Driver Quick Start Guide</a>  </td></tr>
<tr>
<td><a href="../../source/usb/cdn/doc/api_usage_guide.pdf">USB Device Driver APIs</a>  </td></tr>
<tr>
<td><a href="../../source/usb/cdn/doc/core_driver/usb_ss_drd_driver_guide.pdf">USB Device Driver User's Guide</a>  </td></tr>
<tr>
<td><a href="../../source/usb/cdn/doc/porting/porting_guide.pdf">USB Device Driver Porting Guide</a> <ul>
<li>Constants defining module Ids for all modules in USB Device driver. </li>
</ul>
</td></tr>
<tr>
<td colspan="1" bgcolor="#F0F0F0">SOC Porting Layer  </td></tr>
<tr>
<td><a class="el" href="group__USB__MODULE.html">APIs for USB</a>  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
