<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: PMU</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DRIVERS_PMU_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PMU </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1887">Features Supported</a></li>
<li class="level1"><a href="#autotoc_md1888">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md1889">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md1890">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_drivers_pmu"></a></p>
<p>The ARM Cortex R5F core includes logic to detect various events that can occur, for example a cache miss, cache access, etc. These events provide useful information about the behaviour of the processor that you can use when debugging or profiling code. The events are made visible on an output event bus and can be counted using registers in the Performance Monitoring Unit (PMU) of the core. This SW library is an abstraction to the PMU with APIs to profile code blocks.</p>
<p>The PMU consists of three event counting registers, one cycle counting register and 12 CP15 registers, for controlling and interrogating the counters. So in total four profiling metrics are possible for each profile point. Out of this one is fixed, the cycle counter. The other three are programmable to any of the events supported by the R5 core. For details of the events, please refer to the ARM Cortex R5F technical reference manual under section "Events and Performance Monitor"</p>
<h1><a class="anchor" id="autotoc_md1887"></a>
Features Supported</h1>
<p>The driver consists of a high-level interface offering the following features:</p>
<ul>
<li>API to initialize profile object and counters</li>
<li>APIs to start and end profiling</li>
<li>APIs to print stats of a specific profile point or the all the profile points</li>
</ul>
<h1><a class="anchor" id="autotoc_md1888"></a>
Features NOT Supported</h1>
<ul>
<li>Sysconfig configurability of counters is not supported</li>
<li>Counter overflow is not handled (counters are reset for each profile point)</li>
</ul>
<h1><a class="anchor" id="autotoc_md1889"></a>
Example Usage</h1>
<p>Include the below file to access the APIs </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;drivers/pmu.h&gt;</span></div>
</div><!-- fragment --><p> Sample configuration </p><div class="fragment"><div class="line"><a class="code" href="structPMU__EventCfg.html">PMU_EventCfg</a> gPmuEventCfg[3] = </div>
<div class="line">{</div>
<div class="line">    {</div>
<div class="line">        .<a class="code" href="structPMU__EventCfg.html#a159b74cbb41444d51fb15398f9f76566">name</a> = <span class="stringliteral">&quot;ICache Miss&quot;</span>,</div>
<div class="line">        .type = CSL_ARM_R5_PMU_EVENT_TYPE_ICACHE_MISS,</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        .name = <span class="stringliteral">&quot;DCache Access&quot;</span>,</div>
<div class="line">        .type = CSL_ARM_R5_PMU_EVENT_TYPE_DCACHE_ACCESS,</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        .name = <span class="stringliteral">&quot;DCache Miss&quot;</span>,</div>
<div class="line">        .type = CSL_ARM_R5_PMU_EVENT_TYPE_DCACHE_MISS,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structPMU__Config.html">PMU_Config</a> gPmuConfig = </div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="structPMU__Config.html#a56624e5f1cb046504d05760133d02d5b">bCycleCounter</a> = 1,</div>
<div class="line">    .numEventCounters = 3U,</div>
<div class="line">    .eventCounters = gPmuEventCfg,</div>
<div class="line">};</div>
</div><!-- fragment --><p> Initialization </p><div class="fragment"><div class="line">    <a class="code" href="group__DRV__PMU__MODULE.html#ga724c40982922c9bf45b75e6902d10ffd">PMU_init</a>(&amp;gPmuConfig);</div>
</div><!-- fragment --><p> Profiling sample </p><div class="fragment"><div class="line">    <a class="code" href="group__DRV__PMU__MODULE.html#ga5ceb6f23aa5ffc5111bf83e80c54c16a">PMU_profileStart</a>(<span class="stringliteral">&quot;Block1&quot;</span>);</div>
<div class="line">    <span class="comment">/* Code Block 1 */</span></div>
<div class="line">    uint32_t i, j, k = 0;</div>
<div class="line">    uint32_t arr[100] = { 0U };</div>
<div class="line">    <span class="keywordflow">for</span>(i = 0; i &lt; 100; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span>(j = 0; j &lt; 100; j++)</div>
<div class="line">        {</div>
<div class="line">            arr[k] = i + j;</div>
<div class="line">            k = (k+1) % 100;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__DRV__PMU__MODULE.html#gaae6643d07f4e8e8119bae7177d0b5de5">PMU_profileEnd</a>(<span class="stringliteral">&quot;Block1&quot;</span>);</div>
</div><!-- fragment --><p> For more details on usage, please refer <a class="el" href="EXAMPLES_DRIVERS_PMU_MULTIEVENT.html">PMU Multievent</a></p>
<h1><a class="anchor" id="autotoc_md1890"></a>
API</h1>
<p><a class="el" href="group__DRV__PMU__MODULE.html">APIs for PMU</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__DRV__PMU__MODULE_html_ga5ceb6f23aa5ffc5111bf83e80c54c16a"><div class="ttname"><a href="group__DRV__PMU__MODULE.html#ga5ceb6f23aa5ffc5111bf83e80c54c16a">PMU_profileStart</a></div><div class="ttdeci">int32_t PMU_profileStart(const char *name)</div><div class="ttdoc">Function to start profiling with the current configuration.</div></div>
<div class="ttc" id="agroup__DRV__PMU__MODULE_html_ga724c40982922c9bf45b75e6902d10ffd"><div class="ttname"><a href="group__DRV__PMU__MODULE.html#ga724c40982922c9bf45b75e6902d10ffd">PMU_init</a></div><div class="ttdeci">int32_t PMU_init(PMU_Config *cfg)</div><div class="ttdoc">Function to initialize the PMU for profiling.</div></div>
<div class="ttc" id="astructPMU__EventCfg_html"><div class="ttname"><a href="structPMU__EventCfg.html">PMU_EventCfg</a></div><div class="ttdoc">Data structure used in PMU_Config.</div><div class="ttdef"><b>Definition:</b> pmu.h:77</div></div>
<div class="ttc" id="agroup__DRV__PMU__MODULE_html_gaae6643d07f4e8e8119bae7177d0b5de5"><div class="ttname"><a href="group__DRV__PMU__MODULE.html#gaae6643d07f4e8e8119bae7177d0b5de5">PMU_profileEnd</a></div><div class="ttdeci">int32_t PMU_profileEnd(const char *name)</div><div class="ttdoc">Function to end profiling with the current configuration.</div></div>
<div class="ttc" id="astructPMU__Config_html"><div class="ttname"><a href="structPMU__Config.html">PMU_Config</a></div><div class="ttdoc">Data structure to be used with PMU_init.</div><div class="ttdef"><b>Definition:</b> pmu.h:90</div></div>
<div class="ttc" id="astructPMU__Config_html_a56624e5f1cb046504d05760133d02d5b"><div class="ttname"><a href="structPMU__Config.html#a56624e5f1cb046504d05760133d02d5b">PMU_Config::bCycleCounter</a></div><div class="ttdeci">uint32_t bCycleCounter</div><div class="ttdef"><b>Definition:</b> pmu.h:91</div></div>
<div class="ttc" id="astructPMU__EventCfg_html_a159b74cbb41444d51fb15398f9f76566"><div class="ttname"><a href="structPMU__EventCfg.html#a159b74cbb41444d51fb15398f9f76566">PMU_EventCfg::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> pmu.h:80</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
