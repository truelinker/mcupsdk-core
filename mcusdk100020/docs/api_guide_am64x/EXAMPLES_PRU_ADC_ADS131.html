<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: ADS131</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_PRU_ADC_ADS131.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ADS131 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1553">Introduction</a></li>
<li class="level1"><a href="#EXAMPLES_PRU_ADC_ADS131_DEMO_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md1554">Steps to Run the Example</a><ul><li class="level2"><a href="#autotoc_md1555">Features</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md1556">Important files and directory structure</a></li>
<li class="level1"><a href="#autotoc_md1557">Sample Output</a></li>
<li class="level1"><a href="#autotoc_md1558">Sample output with sinwave given as analog input to ADC</a></li>
<li class="level1"><a href="#autotoc_md1559">Implementation Details</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_pru_io_ads131"></a></p>
<h1><a class="anchor" id="autotoc_md1553"></a>
Introduction</h1>
<p>This example uses <a href="https://www.ti.com/product/ADS131M08">ADS131M08</a> ADC IC to convert analog input signal on adc channel to samples and store the results in a shared memory which can be configured by the user (using <a class="el" href="DRIVERS_PRU_IPC.html">PRU IPC</a> module). The read samples are finally printed to the R5F console, or can also be visualized using CCS Graph plotter. GUI Composer app available on TI Gallery can also be used to evaluate the ADC using a GUI based interface.</p>
<p>The example does the below</p><ul>
<li>PRU controls the ADC and reads the samples</li>
<li>PRU program implements ADC samples transfer interface</li>
<li>PRU then writes the samples to a shared memory and creates an interrupt after writing 1 block of data</li>
<li>On interrupt R5F then reads the data and prints it on console</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_PRU_ADC_ADS131_DEMO_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 freertos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ICSSG  </td><td class="markdownTableBodyNone">ICSSG0 - PRU0   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang, pru-cgt   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am64x-evm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/pru_io/adc/ADS131/   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md1554"></a>
Steps to Run the Example</h1>
<ul>
<li>Setup: The ADC EVM is connected to AM64x/AM243x GP EVM using <a href="https://www.ti.com/tool/ADC-PHI-PRU-EVM">ADC-PHI-PRU-EVM Adapter Board</a> inbetween.</li>
</ul>
<p> <style>div.image img[src="ADS131-setup.png"]{width:50%}</style> </p><div class="image">
<img src="ADS131-setup.png" alt=""/>
</div>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project from the above mentioned Example folder path for system_freertos_prufw (It will automatically import R5F and PRU project) for the required combination.</li>
<li>On importing the project, SysConfig will contain an ADC Config instance with default configurations which are compatible with the <a href="https://www.ti.com/tool/ADC-PHI-PRU-EVM">ADC-PHI-PRU-EVM</a> Adapter Board, Use R5F SysConfig to configure the required settings for the ADC IC.</li>
</ul>
<p> <style>div.image img[src="ads131_syscfg.png"]{width:60%}</style> </p><div class="image">
<img src="ads131_syscfg.png" alt=""/>
<div class="caption">
ADC SysConfig Options</div></div>
 <dl class="section user"><dt></dt><dd>You will need to edit linker file whenever changes are made to the configuration for <a class="el" href="DRIVERS_PRU_IPC.html">PRU IPC</a> module, refer <a class="el" href="DRIVERS_PRU_IPC.html#DRIVERS_PRU_IPC_LINKER">Update linker command file</a></dd></dl>
<ul>
<li><p class="startli">Build only the system_freertos_prufw using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</p><ul>
<li>Build Flow: Once you click on build in system_freertos_prufw, first, PRU project is compiled according to the configurations set in PRU SysConfig. Finally the R5F project will be compiled using both the generated R5F SysConfig files and PRU project binaries or PRU Firmware header file.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Prerequisite: <a href="https://www.ti.com/tool/PRU-CGT">PRU-CGT-2-3</a> (ti-pru-cgt) should be installed at: <code>C:/ti/</code></dd></dl>
</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md1555"></a>
Features</h2>
<p>Supported:</p>
<ul>
<li>Serial Interface</li>
<li>Interrupt on receiving a block of data</li>
<li>ADC, Pinmux and other configurations through SysConfig interface</li>
</ul>
<h1><a class="anchor" id="autotoc_md1556"></a>
Important files and directory structure</h1>
<table class="doxtable">
<tr>
<th>Folder/Files </th><th>Description  </th></tr>
<tr>
<td colspan="2" bgcolor="#F0F0F0">${SDK_INSTALL_PATH}/source/pru_io/ </td></tr>
<tr>
<td>firmware/ </td><td>PRU source files providing macros for interfaces, pru_ipc, etc.  </td></tr>
<tr>
<td>driver/ </td><td>PRU IPC source files for sending ADC samples from PRU to R5F  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md1557"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is built and run in debug mode:</p>
<div class="fragment"><div class="line">--------------------------------------------------</div>
<div class="line">Initializing App </div>
<div class="line">Initialized </div>
<div class="line">--------------------------------------------------</div>
<div class="line">Powering up ADC... </div>
<div class="line">ADC Powered Up </div>
<div class="line">--------------------------------------------------</div>
<div class="line">Resetting ADC </div>
<div class="line">--------------------------------------------------</div>
<div class="line">Configuring ADC... </div>
<div class="line">ADC Configuration completed </div>
<div class="line">--------------------------------------------------</div>
<div class="line">Starting ADC Conversion </div>
<div class="line">Started ADC Conversion </div>
<div class="line">--------------------------------------------------</div>
<div class="line">----- Channel: 1 ----- </div>
<div class="line">Sample 1:  1858  </div>
<div class="line">Sample 2:  1552  </div>
<div class="line">Sample 3:  2037  </div>
<div class="line">Sample 4:  1752  </div>
<div class="line">Sample 5:  2005  </div>
<div class="line">----- Channel: 2 ----- </div>
<div class="line">Sample 1:  1214  </div>
<div class="line">Sample 2:  1372  </div>
<div class="line">Sample 3:  1256  </div>
<div class="line">Sample 4:  1425  </div>
<div class="line">Sample 5:  1034 </div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1558"></a>
Sample output with sinwave given as analog input to ADC</h1>
<ul>
<li><a href="https://www.ti.com/tool/PSIEVM">Precision signal injector</a> is used to give analog input to ADC which can be configured using <a href="https://www.ti.com/tool/download/SBAC170">GUI</a>, use the configurations shown below</li>
</ul>
<p> <style>div.image img[src="precision_signal_generator_gui.png"]{width:50%}</style> </p><div class="image">
<img src="precision_signal_generator_gui.png" alt=""/>
</div>
<ul>
<li><a href="https://software-dl.ti.com/ccs/esd/documents/users_guide/ccs_debug-graphs.html">CCS graph tool</a> can be used to plot graph using digital data from ADC, PRU IPC start buffer address for each channel can found in linker command file of R5F project, sample output when sin wave is given as input is shown below</li>
</ul>
<p> <style>div.image img[src="sinwave_output.png"]{width:50%}</style> </p><div class="image">
<img src="sinwave_output.png" alt=""/>
</div>
<h1><a class="anchor" id="autotoc_md1559"></a>
Implementation Details</h1>
<p>Refer here for complete implementation explanation: <a class="el" href="EXAMPLES_PRU_ADC_ADS131_DETAILS.html">ADS131 Implementation Details</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
