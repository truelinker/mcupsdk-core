<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: Debug</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('KERNEL_DPL_DEBUG_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Debug </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1636">Features Supported</a></li>
<li class="level1"><a href="#autotoc_md1637">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md1638">Important Usage Guidelines</a><ul><li class="level2"><a href="#autotoc_md1639">Shared memory logging</a></li>
<li class="level2"><a href="#autotoc_md1640">UART logging</a></li>
<li class="level2"><a href="#autotoc_md1641">Memory logging</a></li>
<li class="level2"><a href="#autotoc_md1642">Other guidelines</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md1643">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md1644">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_kernel_dpl_DebugP"></a></p>
<h1><a class="anchor" id="autotoc_md1636"></a>
Features Supported</h1>
<ul>
<li>APIs to log strings to the selected console</li>
<li>APIs to assert if a expression evaluates to 0<ul>
<li>Before asserting, it will log the file and line number to console</li>
</ul>
</li>
<li>Ability to disable assert's and logging via a pre-processor define</li>
<li>The following console options are supported<ul>
<li>Log to CCS IDE console via JTAG</li>
<li>Log to UART terminal</li>
<li>Log to shared memory, can be viewed via the CPU on which log reader is enabled</li>
<li>Log to CPU local memory, can be viewed via ROV in CCS or when Linux is enabled via Linux kernel debugfs</li>
</ul>
</li>
<li>Ability to read logs from shared memory and output to selected console.</li>
<li>SysCfg support for below,<ul>
<li>SysCfg can be used to select the log console</li>
<li>When UART log is selected, SysCfg allows to select the UART instance and its properties (baud rate etc) to use.</li>
<li>SysCfg option to enable shared memory reader task</li>
</ul>
</li>
<li>APIs to read line as string and/or format input in scanf style from UART console.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1637"></a>
Features NOT Supported</h1>
<ul>
<li>Log APIs should not be called from ISR context. When called in ISR the APIs have no effect.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1638"></a>
Important Usage Guidelines</h1>
<h2><a class="anchor" id="autotoc_md1639"></a>
Shared memory logging</h2>
<ul>
<li>The core on which the shared memory reader is enabled, the option to use shared memory writer is ignored.</li>
<li>When shared memory writer/reader is enabled, a shared memory section is used to write and read the strings for all the cores,<ul>
<li>When SysCfg is used, the array representing this shared memory is generated in the file <code>ti_dpl_config.c</code>.</li>
<li>Place the section attributed to this array in the linker command file for each core such that all cores point to the same memory address for this section.</li>
<li>And this memory section should be marked as non-cache in the MPU/MMU entry for each core.</li>
</ul>
</li>
<li>It is recommended to enable UART logging and shared memory reader on one "main" core and other core's should enable the shared memory writer.</li>
<li>The memory used for logging is limited per core. If the writer is faster than reader, then the writer drops the characters to be printed.</li>
<li>To change the size of the log buffer, change the value of <a class="el" href="group__KERNEL__DPL__DEBUG.html#ga339794276863c87430f83deb5a1e798c">DebugP_SHM_LOG_SIZE</a> in <code><a class="el" href="DebugP_8h.html">source/kernel/dpl/DebugP.h</a></code>. <dl class="section note"><dt>Note</dt><dd>When shared memory reader is enabled for a nortos application user needs to invoke <a class="el" href="group__KERNEL__DPL__DEBUG.html#gaf997bf25164b3cc752a2a8b3e1d6d5fe">DebugP_shmLogRead</a> API to read logs from shared memory. <a class="el" href="group__KERNEL__DPL__DEBUG.html#gaf997bf25164b3cc752a2a8b3e1d6d5fe">DebugP_shmLogRead</a> will read the log once and exit thus application needs to call this API periodically in-order to gather continous logs.</dd></dl>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1640"></a>
UART logging</h2>
<ul>
<li>Make sure the selected UART driver is opened for the logs to be output to UART.<ul>
<li>When enabled via SysCfg, calling the function <code>Drivers_open</code> opens and initializes the UART for logging.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1641"></a>
Memory logging</h2>
<ul>
<li>When log to memory is enabled, the log can be viewed via ROV (see <a class="el" href="ROV_INTRO_PAGE.html">Using SDK with Real-time Object View (ROV)</a>) in CCS</li>
<li>The memory used for logging is limited. The writer is typically faster than the ROV reader, so here the writer will overwrite the older data, i.e the log will have the latest logs up to log buffer size.</li>
<li>To change the size of the log buffer, change the value of <a class="el" href="group__KERNEL__DPL__DEBUG.html#ga5567d1d9d00dd9556c61e30dabb0f551">DebugP_MEM_LOG_SIZE</a> in <code><a class="el" href="DebugP_8h.html">source/kernel/dpl/DebugP.h</a></code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1642"></a>
Other guidelines</h2>
<ul>
<li>Log and assert APIs should not be called from ISR context.</li>
<li>The assert and logging APIs are task or thread safe, i.e they can be called from multiple tasks without the output getting mixed.</li>
<li>The cores on which CCS or UART or shared memory writer is enabled can use either NORTOS or FreeRTOS.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1643"></a>
Example Usage</h1>
<p>Include the below file to access the APIs, </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="DebugP_8h.html">kernel/dpl/DebugP.h</a>&gt;</span></div>
</div><!-- fragment --><p> Example usage for assert, </p><div class="fragment"><div class="line">    <span class="keywordtype">void</span> *<a class="code" href="csl__udmap__tr_8h.html#a0e89cf6b9f6cd3125470b1bed2b823df">addr</a> = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* This will assert when addr is NULL */</span></div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(<a class="code" href="csl__udmap__tr_8h.html#a0e89cf6b9f6cd3125470b1bed2b823df">addr</a>!=NULL);</div>
</div><!-- fragment --><p> Example usage for logs, </p><div class="fragment"><div class="line">    uint32_t <a class="code" href="tisci__otp__revision_8h.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a> = 10;</div>
<div class="line">    <span class="keywordtype">char</span> *<a class="code" href="tisci__core_8h.html#a54588a2c3c3e6d0a491698fbd63c52e2">str</a> = <span class="stringliteral">&quot;Hello, world !!!&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* use snprintf to format the string and then call the logging function */</span></div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;This is %s and value = %d&quot;</span>,</div>
<div class="line">        <a class="code" href="tisci__core_8h.html#a54588a2c3c3e6d0a491698fbd63c52e2">str</a>,</div>
<div class="line">        <a class="code" href="tisci__otp__revision_8h.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a>);</div>
</div><!-- fragment --><p> Example usage for scanf, </p><div class="fragment"><div class="line">    uint32_t value32;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;Enter a 32b number\r\n&quot;</span>);</div>
<div class="line">    value32 = 0;</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga5c767649af82b6ee94fd3918500eae87">DebugP_scanf</a>(<span class="stringliteral">&quot;%d&quot;</span>, &amp;value32);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a>(<span class="stringliteral">&quot;32b value = %d\r\n&quot;</span>, value32);</div>
</div><!-- fragment --><p>Example snippet to show linker command file placement of the shared memory log section generated via SysCfg,</p>
<div class="fragment"><div class="line">SECTIONS</div>
<div class="line">{</div>
<div class="line">    /* this is used when Debug log&#39;s to shared memory are enabled, else this is not used */</div>
<div class="line">    .bss.log_shared_mem  (NOLOAD) : {} &gt; LOG_SHM_MEM</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">MEMORY</div>
<div class="line">{</div>
<div class="line">    /* shared memories that are used by all cores */</div>
<div class="line">    /* On M4F,</div>
<div class="line">     * - By default MSMC RAM is not accessible to M4F, a RAT entry is needed to make it</div>
<div class="line">     *   accessible on M4F</div>
<div class="line">     * - So make sure there is a RAT entry which has a 1:1 mapping from 0x70000000 to 0x70200000</div>
<div class="line">     */</div>
<div class="line">    /* On R5F,</div>
<div class="line">     * - make sure there is a MPU entry which maps below regions as non-cache</div>
<div class="line">     */</div>
<div class="line">    LOG_SHM_MEM  : ORIGIN = 0x701D4000, LENGTH = 0x00004000</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1644"></a>
API</h1>
<p><a class="el" href="group__KERNEL__DPL__DEBUG.html">APIs for Debug log's and assert's</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="acsl__udmap__tr_8h_html_a0e89cf6b9f6cd3125470b1bed2b823df"><div class="ttname"><a href="csl__udmap__tr_8h.html#a0e89cf6b9f6cd3125470b1bed2b823df">addr</a></div><div class="ttdeci">uint64_t addr</div><div class="ttdef"><b>Definition:</b> csl_udmap_tr.h:3</div></div>
<div class="ttc" id="atisci__core_8h_html_a54588a2c3c3e6d0a491698fbd63c52e2"><div class="ttname"><a href="tisci__core_8h.html#a54588a2c3c3e6d0a491698fbd63c52e2">str</a></div><div class="ttdeci">char str[32]</div><div class="ttdef"><b>Definition:</b> tisci_core.h:1</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_gafe348ab5badd2c15118f95e21bb192c6"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#gafe348ab5badd2c15118f95e21bb192c6">DebugP_log</a></div><div class="ttdeci">#define DebugP_log(format,...)</div><div class="ttdoc">Function to log a string to the enabled console.</div><div class="ttdef"><b>Definition:</b> DebugP.h:225</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_ga5c767649af82b6ee94fd3918500eae87"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#ga5c767649af82b6ee94fd3918500eae87">DebugP_scanf</a></div><div class="ttdeci">int32_t DebugP_scanf(char *format,...)</div><div class="ttdoc">Read a formatted string from the selected UART driver.</div></div>
<div class="ttc" id="atisci__otp__revision_8h_html_ae7f66047e6e39ba2bb6af8b95f00d1dd"><div class="ttname"><a href="tisci__otp__revision_8h.html#ae7f66047e6e39ba2bb6af8b95f00d1dd">value</a></div><div class="ttdeci">uint32_t value</div><div class="ttdef"><b>Definition:</b> tisci_otp_revision.h:2</div></div>
<div class="ttc" id="aDebugP_8h_html"><div class="ttname"><a href="DebugP_8h.html">DebugP.h</a></div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_ga552e9055ca7eab5fe6c224c6cd5a9d4c"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a></div><div class="ttdeci">#define DebugP_assert(expression)</div><div class="ttdoc">Function to call for assert check.</div><div class="ttdef"><b>Definition:</b> DebugP.h:177</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
