<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: Enet EST/TAS Support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM64x MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">10.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('enet_tas_top.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Enet EST/TAS Support </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#enet_est_intro">Introduction</a><ul><li class="level2"><a href="#enet_est_intro_est_tas">IEEE 802.1Qbv EST/TAS</a></li>
<li class="level2"><a href="#enet_est_intro_guard_band">Guard band</a></li>
</ul>
</li>
<li class="level1"><a href="#enet_est_api">Enet LLD API</a></li>
<li class="level1"><a href="#enet_est_cpsw">CPSW Support</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_networking_enet_lld_enet_tas"></a></p>
<h1><a class="anchor" id="enet_est_intro"></a>
Introduction</h1>
<h2><a class="anchor" id="enet_est_intro_est_tas"></a>
IEEE 802.1Qbv EST/TAS</h2>
<p>IEEE 802.1Qbv <a href="https://en.wikipedia.org/wiki/Time-Sensitive_Networking#IEEE_802.1Qbv_Enhancements_to_Traffic_Scheduling:_Time-Aware_Shaper_(TAS)">Time-Aware Shaper</a> (TAS), which is also called <em>Enhancements for Scheduled Traffic</em> (EST) in IEEE Std 802.1Q-2018, defines a mechanism to allocate and grant exclusive Ethernet port transmission access on repeating cycles which are divided into slices where traffic of specific traffic class queues can be selected for transmission as per use-case requirements.</p>
<p>The diagram below shows a generic EST schedule composed of <em>n</em> slices (also called <em>time intervals</em>), each slice has specific <em>gate mask</em> that defines the state of each <em>transmission gate</em>: <em>open</em> or <em>closed</em>.</p>
<div class="image">
<img src="EST_Schedule_Diagram.png" alt=""/>
<div class="caption">
EST schedule</div></div>
<p><em>Transmission gates</em> are associated with specific traffic class queues (0-7). When a gate is <em>open</em>, frames from the corresponding queue can be selected for transmission. When the gate is <em>closed</em>, frames from the corresponding queue will not be selected for transmission. It's up to the application to determine the duration of each time slice and the state of each transmission gate.</p>
<p>The list of all gate states for all slices in the cycle is called <em>gate control list</em>. The control list that is programmed is called <em>administrative list</em>, when list becomes active is then called <em>operational list</em>.</p>
<p>For further information about TAS/EST specification, please refer to section <em>8.6.9 Scheduled traffic state machines</em> of IEEE 802.1Q-2018 standard document.</p>
<h2><a class="anchor" id="enet_est_intro_guard_band"></a>
Guard band</h2>
<p>It's worth noting that in EST, the transmission of a frame will not be interrupted, the full frame transmission will be completed even if it spills over the next time slice. This could pose a problem when traffic from the previous time slice, potentially of lower priority, spills over the next time slice meant for higher priority traffic.</p>
<p>A <a href="https://en.wikipedia.org/wiki/Time-Sensitive_Networking#IEEE_802.1Qbv_in_more_detail:_Time_slices_and_guard_bands">guard band</a>, which is a time slice with all gates closed, can be added right before critical time slices to ensure that wire is cleared of any previous traffic. The duration of the guard band must be set long enough for a packet of MTU size that initiated transmission right before the non-critical time slice ended had been fully transmitted.</p>
<p><a class="el" href="enet_tas_top.html">Back To Top</a></p>
<h1><a class="anchor" id="enet_est_api"></a>
Enet LLD API</h1>
<p>Enet LLD provides support for TAS/EST through the IOCTLs described in the <a class="el" href="group__ENET__MOD__TAS.html">Enet Time Aware Shaper</a> API Guide. The most important IOCTLs are listed below:</p>
<ul>
<li><a class="el" href="group__ENET__MOD__TAS.html#ggada0ad2c0a7a0c6530e49a3dd78c09ab2aa50cd9fdb7cb503427624610d7b3db61">ENET_TAS_IOCTL_SET_STATE</a>. Sets the state of TAS module for each MAC port:<ul>
<li><a class="el" href="group__ENET__MOD__TAS.html#gga3acb36109645d538c493fd97c7dc817ca292753a3b16c05651371772a1de565a1">ENET_TAS_RESET</a> to reset the state machine.</li>
<li><a class="el" href="group__ENET__MOD__TAS.html#gga3acb36109645d538c493fd97c7dc817ca22dfbd3f27824d920781a1e80e760e23">ENET_TAS_ENABLE</a> to start EST/TAS after a valid administrative list has been programmed.</li>
<li><a class="el" href="group__ENET__MOD__TAS.html#gga3acb36109645d538c493fd97c7dc817ca09b78dc8dc4d5f4129f855271ee9d8cf">ENET_TAS_DISABLE</a> to stop (idle) EST/TAS.</li>
</ul>
</li>
<li><a class="el" href="group__ENET__MOD__TAS.html#ggada0ad2c0a7a0c6530e49a3dd78c09ab2a2d555672c01e2a6720fd139936844561">ENET_TAS_IOCTL_SET_ADMIN_LIST</a>. Sets a new administrative list of type <a class="el" href="structEnetTas__ControlList.html">EnetTas_ControlList</a>. The gate control list is composed of:<ul>
<li><a class="el" href="structEnetTas__ControlList.html#a7f406efcb3b84f71ada4a61c9b3ea63f">baseTime</a>. The administrative base time which determines when the administrative list will become active.<ul>
<li>The base time can be set to a timestamp in the past, in which case the administrative list should become active right away.</li>
<li>The base time can also be set to a timestamp in the future, but note that not all Ethernet peripherals may fully support this feature.</li>
</ul>
</li>
<li><a class="el" href="structEnetTas__ControlList.html#ab6866461954473b6dbd7aa9db1f0a11e">gateCmdList</a>. The actual gate control list defined as list of <em>time interval duration</em> and <em>gate state mask</em> pairs. Enet LLD supports up to 16 intervals for simplicity, though some Ethernet peripherals may support larger number of intervals.</li>
<li><a class="el" href="structEnetTas__ControlList.html#afd4da3b610a5ee1f2cae3ab64673c471">listLength</a>. The number of entries in the gate control list.</li>
<li><a class="el" href="structEnetTas__ControlList.html#afffb7eefd4adf29b44118ed1680ad1c1">cycleTime</a>. The repeating cycle time.<ul>
<li>If it's larger that the accumulated time of all the intervals in the control list, the last time interval gets <em>extended</em> till end of the cycle.</li>
<li>If it's shorter than the accumulated interval time, then the gate control list gets <em>truncated</em> as per cycle time.</li>
</ul>
</li>
<li><a class="el" href="structEnetTas__ControlList.html#ab3c74ff9df91f1c1bb2df040cfb2be62">sduTable</a>. The maximum service data unit (SDU) per queue.</li>
</ul>
</li>
<li><a class="el" href="group__ENET__MOD__TAS.html#ggada0ad2c0a7a0c6530e49a3dd78c09ab2adf819fd64596c65886ac45fe7ce64fde">ENET_TAS_IOCTL_GET_OPER_LIST_STATUS</a>. Gets the status of the operational list update. It must be called after a new operational list has been set until driver acknowledges that the operational list has been updated by returning <a class="el" href="group__ENET__MOD__TAS.html#ggac07caadee47eaf55259b4afdf5b918aaa1c2a33d1c552b4cc747878fe6b0959a4">ENET_TAS_OPER_LIST_UPDATED</a>.</li>
<li><a class="el" href="group__ENET__MOD__TAS.html#ggada0ad2c0a7a0c6530e49a3dd78c09ab2adf819fd64596c65886ac45fe7ce64fde">ENET_TAS_IOCTL_GET_OPER_LIST_STATUS</a>. Gets the current operational list. It must be called after valid administrative list has been programmed. The operational list is a structure of type <a class="el" href="structEnetTas__ControlList.html">EnetTas_ControlList</a> which is the same type used for administrative lists describer earlier.</li>
</ul>
<p>The call sequence in the following diagram illustrates the typical usage of Enet LLD IOCTLs to configure EST/TAS on a given MAC port.</p>
<div class="image">
<img src="Enet_Est.png" alt=""/>
<div class="caption">
TAS IOCTL sequence in Enet LLD</div></div>
<p><a class="el" href="enet_tas_top.html">Back To Top</a></p>
<h1><a class="anchor" id="enet_est_cpsw"></a>
CPSW Support</h1>
<p>Enet LLD does not support CPSW EST for this SoC.</p>
<p><a class="el" href="enet_tas_top.html">Back To Top</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
